<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 The one-sample t-test | An R companion to Statistics: data analysis and modelling</title>
  <meta name="description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 The one-sample t-test | An R companion to Statistics: data analysis and modelling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="github-repo" content="mspeekenbrink/sdam-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The one-sample t-test | An R companion to Statistics: data analysis and modelling" />
  
  <meta name="twitter:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  

<meta name="author" content="Maarten Speekenbrink" />


<meta name="date" content="2022-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-modelling.html"/>
<link rel="next" href="regression.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#download-r"><i class="fa fa-check"></i><b>1.2.1</b> Download R</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#download-r-studio"><i class="fa fa-check"></i><b>1.2.2</b> Download R Studio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#working-with-rstudio"><i class="fa fa-check"></i><b>1.3</b> Working with RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing packages</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#installing-the-sdamr-package"><i class="fa fa-check"></i><b>1.4.1</b> Installing the <code>sdamr</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#loading-packages"><i class="fa fa-check"></i><b>1.4.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.5</b> Getting help</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#first-steps-r-as-a-calculator"><i class="fa fa-check"></i><b>1.6</b> First steps: R as a calculator</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#data"><i class="fa fa-check"></i><b>1.7</b> Data</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.7.1</b> Data types</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction.html"><a href="introduction.html#objects"><i class="fa fa-check"></i><b>1.7.2</b> Objects</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction.html"><a href="introduction.html#importing-data"><i class="fa fa-check"></i><b>1.7.3</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#exploring-data-descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Exploring data: Descriptive statistics</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#exploring-data-creating-plots"><i class="fa fa-check"></i><b>1.9</b> Exploring data: Creating plots</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#histogram"><i class="fa fa-check"></i><b>1.9.1</b> Histogram</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#boxplot"><i class="fa fa-check"></i><b>1.9.2</b> Boxplot</a></li>
<li class="chapter" data-level="1.9.3" data-path="introduction.html"><a href="introduction.html#scatterplot"><i class="fa fa-check"></i><b>1.9.3</b> Scatterplot</a></li>
<li class="chapter" data-level="1.9.4" data-path="introduction.html"><a href="introduction.html#raincloud-plot"><i class="fa fa-check"></i><b>1.9.4</b> Raincloud plot</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#a-note-about-namespaces-and-loading-packages"><i class="fa fa-check"></i><b>1.10</b> A note about namespaces and loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-modelling.html"><a href="statistical-modelling.html"><i class="fa fa-check"></i><b>2</b> Statistical modelling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#distributions"><i class="fa fa-check"></i><b>2.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#generating-random-data"><i class="fa fa-check"></i><b>2.1.1</b> Generating random data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#estimation"><i class="fa fa-check"></i><b>2.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#the-likelihood-function"><i class="fa fa-check"></i><b>2.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#calculating-the-likelihood-ratio"><i class="fa fa-check"></i><b>2.2.2</b> Calculating the likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-modelling.html"><a href="statistical-modelling.html#hypothesis-testing-directly-with-the-binomial-distribution"><i class="fa fa-check"></i><b>2.3</b> Hypothesis testing directly with the binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html"><i class="fa fa-check"></i><b>3</b> The one-sample t-test</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#missing-values"><i class="fa fa-check"></i><b>3.1</b> Missing values</a></li>
<li class="chapter" data-level="3.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#selecting-subsets-of-data"><i class="fa fa-check"></i><b>3.2</b> Selecting subsets of data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#indexing-variables"><i class="fa fa-check"></i><b>3.2.1</b> Indexing variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#the-subset-function"><i class="fa fa-check"></i><b>3.2.2</b> The <code>subset</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> One-sample t-test</a></li>
<li class="chapter" data-level="3.4" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#effect-size"><i class="fa fa-check"></i><b>3.4</b> Effect size</a></li>
<li class="chapter" data-level="3.5" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#nonparametric-bootstrap"><i class="fa fa-check"></i><b>3.5</b> Nonparametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>4</b> Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression.html"><a href="regression.html#estimating-an-testing-a-simple-regression-model"><i class="fa fa-check"></i><b>4.1</b> Estimating an testing a simple regression model</a></li>
<li class="chapter" data-level="4.2" data-path="regression.html"><a href="regression.html#model-comparisons"><i class="fa fa-check"></i><b>4.2</b> Model comparisons</a></li>
<li class="chapter" data-level="4.3" data-path="regression.html"><a href="regression.html#estimating-and-testing-a-multiple-regression-model"><i class="fa fa-check"></i><b>4.3</b> Estimating and testing a multiple regression model</a></li>
<li class="chapter" data-level="4.4" data-path="regression.html"><a href="regression.html#residuals-and-predicted-values"><i class="fa fa-check"></i><b>4.4</b> Residuals and predicted values</a></li>
<li class="chapter" data-level="4.5" data-path="regression.html"><a href="regression.html#plotting-pairwise-scatterplots-for-many-variables"><i class="fa fa-check"></i><b>4.5</b> Plotting pairwise scatterplots for many variables</a></li>
<li class="chapter" data-level="4.6" data-path="regression.html"><a href="regression.html#multicollinearity-and-outlier-detection"><i class="fa fa-check"></i><b>4.6</b> Multicollinearity and outlier detection</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html"><i class="fa fa-check"></i><b>5</b> Moderation and mediation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#moderation-in-linear-models"><i class="fa fa-check"></i><b>5.1</b> Moderation in linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#a-reminder-about-namespaces"><i class="fa fa-check"></i><b>5.1.1</b> A reminder about namespaces</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#centering"><i class="fa fa-check"></i><b>5.2</b> Centering</a></li>
<li class="chapter" data-level="5.3" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#mediation-analysis"><i class="fa fa-check"></i><b>5.3</b> Mediation analysis</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#causal-steps"><i class="fa fa-check"></i><b>5.3.1</b> Causal steps</a></li>
<li class="chapter" data-level="5.3.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#investigating-the-moderated-indirect-effect-with-a-bootstrap-test"><i class="fa fa-check"></i><b>5.3.2</b> Investigating the moderated (indirect) effect with a bootstrap test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html"><i class="fa fa-check"></i><b>6</b> Contrast coding and oneway ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#computing-contrast-coded-predictors"><i class="fa fa-check"></i><b>6.1</b> Computing contrast-coded predictors</a></li>
<li class="chapter" data-level="6.2" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#assigning-contrasts-to-factors"><i class="fa fa-check"></i><b>6.2</b> Assigning contrasts to factors</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#default-coding-schemes"><i class="fa fa-check"></i><b>6.2.1</b> Default coding schemes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="factorial-anova.html"><a href="factorial-anova.html"><i class="fa fa-check"></i><b>7</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="factorial-anova.html"><a href="factorial-anova.html#rainclouds-for-factorial-designs"><i class="fa fa-check"></i><b>7.1</b> Rainclouds for factorial designs</a></li>
<li class="chapter" data-level="7.2" data-path="factorial-anova.html"><a href="factorial-anova.html#formulating-estimating-and-testing-a-factorial-anova"><i class="fa fa-check"></i><b>7.2</b> Formulating, estimating, and testing a factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="factorial-anova.html"><a href="factorial-anova.html#a-threeway-anova"><i class="fa fa-check"></i><b>7.2.1</b> A threeway ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="factorial-anova.html"><a href="factorial-anova.html#type-1-2-and-3-sums-of-squares"><i class="fa fa-check"></i><b>7.3</b> Type 1, 2, and 3 Sums of Squares</a></li>
<li class="chapter" data-level="7.4" data-path="factorial-anova.html"><a href="factorial-anova.html#planned-comparisons-and-post-hoc-tests-with-emmeans"><i class="fa fa-check"></i><b>7.4</b> Planned comparisons and post-hoc tests with <code>emmeans</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="factorial-anova.html"><a href="factorial-anova.html#adjusted-p-values"><i class="fa fa-check"></i><b>7.4.1</b> Adjusted p-values</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="factorial-anova.html"><a href="factorial-anova.html#testing-general-contrasts-with-emmeans"><i class="fa fa-check"></i><b>7.5</b> Testing general contrasts with <code>emmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>8</b> Repeated-measures ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#long-and-wide-data"><i class="fa fa-check"></i><b>8.1</b> Long and wide data</a></li>
<li class="chapter" data-level="8.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-separate-glms"><i class="fa fa-check"></i><b>8.2</b> Repeated-measures ANOVA with separate GLMs</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#computing-within-subjects-composite-scores"><i class="fa fa-check"></i><b>8.2.1</b> Computing within-subjects composite scores</a></li>
<li class="chapter" data-level="8.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#performing-a-repeated-measures-anova-with-separate-models"><i class="fa fa-check"></i><b>8.2.2</b> Performing a repeated-measures ANOVA with separate models</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-car-package"><i class="fa fa-check"></i><b>8.3</b> Repeated-measures ANOVA with the <code>car</code> package</a></li>
<li class="chapter" data-level="8.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-afex-package"><i class="fa fa-check"></i><b>8.4</b> Repeated-measures ANOVA with the <code>afex</code> package</a></li>
<li class="chapter" data-level="8.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#contrasts-with-the-emmeans-package"><i class="fa fa-check"></i><b>8.5</b> Contrasts with the <code>emmeans</code> package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>9</b> Linear mixed-effects models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#formulating-and-estimating-linear-mixed-effects-models-with-lme4"><i class="fa fa-check"></i><b>9.1</b> Formulating and estimating linear mixed-effects models with <code>lme4</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-model"><i class="fa fa-check"></i><b>9.1.1</b> Random intercepts model</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#visually-assessing-model-assumptions"><i class="fa fa-check"></i><b>9.1.2</b> Visually assessing model assumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-and-slopes"><i class="fa fa-check"></i><b>9.1.3</b> Random intercepts and slopes</a></li>
<li class="chapter" data-level="9.1.4" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#likelihood-ratio-test-with-the-anova-function"><i class="fa fa-check"></i><b>9.1.4</b> Likelihood ratio test with the <code>anova</code> function</a></li>
<li class="chapter" data-level="9.1.5" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.1.6" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#plotting-model-predictions"><i class="fa fa-check"></i><b>9.1.6</b> Plotting model predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#obtaining-p-values-with-afexmixed"><i class="fa fa-check"></i><b>9.2</b> Obtaining p-values with <code>afex::mixed</code></a></li>
<li class="chapter" data-level="9.3" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#crossed-random-effects"><i class="fa fa-check"></i><b>9.3</b> Crossed random effects</a></li>
<li class="chapter" data-level="9.4" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#automatically-finding-optimal-random-effects-structures-with-the-buildmer-package"><i class="fa fa-check"></i><b>9.4</b> Automatically finding optimal random effects structures with the <code>buildmer</code> package</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>10</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#model-estimation-and-inference"><i class="fa fa-check"></i><b>10.1</b> Model estimation and inference</a></li>
<li class="chapter" data-level="10.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#confidence-intervals-1"><i class="fa fa-check"></i><b>10.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="10.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#model-predictions"><i class="fa fa-check"></i><b>10.3</b> Model predictions</a></li>
<li class="chapter" data-level="10.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#alternative-link-functions-for-logistic-regression"><i class="fa fa-check"></i><b>10.4</b> Alternative link functions for logistic regression</a></li>
<li class="chapter" data-level="10.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#quasi-poisson-regression"><i class="fa fa-check"></i><b>10.5</b> Quasi-Poisson regression</a></li>
<li class="chapter" data-level="10.6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#log-linear-models"><i class="fa fa-check"></i><b>10.6</b> Log-linear models</a></li>
<li class="chapter" data-level="10.7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#multinomial-regression"><i class="fa fa-check"></i><b>10.7</b> Multinomial regression</a></li>
<li class="chapter" data-level="10.8" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#generalized-linear-mixed-effects-models"><i class="fa fa-check"></i><b>10.8</b> Generalized linear mixed effects models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html"><i class="fa fa-check"></i><b>11</b> Structural Equation modelling with lavaan</a>
<ul>
<li class="chapter" data-level="11.1" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#lavaan"><i class="fa fa-check"></i><b>11.1</b> Lavaan</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#the-lavaan-model-syntax"><i class="fa fa-check"></i><b>11.1.1</b> The lavaan model syntax</a></li>
<li class="chapter" data-level="11.1.2" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#model-estimation"><i class="fa fa-check"></i><b>11.1.2</b> Model estimation</a></li>
<li class="chapter" data-level="11.1.3" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#extracting-results"><i class="fa fa-check"></i><b>11.1.3</b> Extracting results</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#plotting-sem-models-with-the-semplot-package"><i class="fa fa-check"></i><b>11.2</b> Plotting SEM models with the <code>semPlot</code> package</a></li>
<li class="chapter" data-level="11.3" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#path-models"><i class="fa fa-check"></i><b>11.3</b> Path models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#regression-models"><i class="fa fa-check"></i><b>11.3.1</b> Regression models</a></li>
<li class="chapter" data-level="11.3.2" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#mediation-models"><i class="fa fa-check"></i><b>11.3.2</b> Mediation models</a></li>
<li class="chapter" data-level="11.3.3" data-path="structural-equation-modelling-with-lavaan.html"><a href="structural-equation-modelling-with-lavaan.html#a-more-complex-path-model"><i class="fa fa-check"></i><b>11.3.3</b> A more complex path model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-estimation.html"><a href="bayesian-estimation.html"><i class="fa fa-check"></i><b>12</b> Bayesian estimation</a></li>
<li class="chapter" data-level="13" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html"><i class="fa fa-check"></i><b>13</b> Bayesian hypothesis testing with Bayes Factors</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#the-bayesfactor-package"><i class="fa fa-check"></i><b>13.1</b> The <code>BayesFactor</code> package</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#a-bayesian-one-sample-t-test"><i class="fa fa-check"></i><b>13.1.1</b> A Bayesian one-sample t-test</a></li>
<li class="chapter" data-level="13.1.2" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#a-bayesian-two-sample-t-test"><i class="fa fa-check"></i><b>13.1.2</b> A Bayesian two-sample t-test</a></li>
<li class="chapter" data-level="13.1.3" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#a-bayesian-anova"><i class="fa fa-check"></i><b>13.1.3</b> A Bayesian ANOVA</a></li>
<li class="chapter" data-level="13.1.4" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#bayesian-regression-and-ancova"><i class="fa fa-check"></i><b>13.1.4</b> Bayesian regression and ANCOVA</a></li>
<li class="chapter" data-level="13.1.5" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#bayesian-repeated-measures-anova"><i class="fa fa-check"></i><b>13.1.5</b> Bayesian repeated-measures ANOVA</a></li>
<li class="chapter" data-level="13.1.6" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#parameter-estimates"><i class="fa fa-check"></i><b>13.1.6</b> Parameter estimates</a></li>
<li class="chapter" data-level="13.1.7" data-path="bayesian-hypothesis-testing-with-bayes-factors.html"><a href="bayesian-hypothesis-testing-with-bayes-factors.html#highest-density-interval"><i class="fa fa-check"></i><b>13.1.7</b> Highest-density interval</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html"><i class="fa fa-check"></i><b>14</b> Reproducible reports with RMarkdown</a>
<ul>
<li class="chapter" data-level="14.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#yaml-headers"><i class="fa fa-check"></i><b>14.1</b> YAML headers</a></li>
<li class="chapter" data-level="14.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#markdown-syntax"><i class="fa fa-check"></i><b>14.2</b> Markdown syntax</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#inline-formatting"><i class="fa fa-check"></i><b>14.2.1</b> Inline formatting</a></li>
<li class="chapter" data-level="14.2.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#block-level-elements"><i class="fa fa-check"></i><b>14.2.2</b> Block-level elements</a></li>
<li class="chapter" data-level="14.2.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#math-expressions"><i class="fa fa-check"></i><b>14.2.3</b> Math expressions</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#r-code"><i class="fa fa-check"></i><b>14.3</b> R code chunks and inline R code</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#figures"><i class="fa fa-check"></i><b>14.3.1</b> Figures</a></li>
<li class="chapter" data-level="14.3.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#tables"><i class="fa fa-check"></i><b>14.3.2</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#apa-documents-with-papaja"><i class="fa fa-check"></i><b>14.4</b> APA documents with <code>papaja</code></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#installation"><i class="fa fa-check"></i><b>14.4.1</b> Installation</a></li>
<li class="chapter" data-level="14.4.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#how-to-use-papaja"><i class="fa fa-check"></i><b>14.4.2</b> How to use papaja</a></li>
<li class="chapter" data-level="14.4.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#getting-help-1"><i class="fa fa-check"></i><b>14.4.3</b> Getting help</a></li>
<li class="chapter" data-level="14.4.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#other-related-r-packages"><i class="fa fa-check"></i><b>14.4.4</b> Other related R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R companion to Statistics: data analysis and modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-one-sample-t-test" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> The one-sample t-test<a href="the-one-sample-t-test.html#the-one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can open the anchoring data as follows:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="the-one-sample-t-test.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb103-2"><a href="the-one-sample-t-test.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(anchoring)</span></code></pre></div>
<p>And view the first few rows of the data with the <code>head</code> function:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="the-one-sample-t-test.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anchoring)</span></code></pre></div>
<pre><code>##   session_id sex age citizenship referrer us_or_international lab_or_online
## 1    2400853   f  18          US abington                  US        In-lab
## 2    2400856   f  19          CN abington                  US        In-lab
## 3    2400860   f  18          US abington                  US        In-lab
## 4    2400868   m  18          US abington                  US        In-lab
## 5    2400914   f  18          US abington                  US        In-lab
## 6    2400916   f  18          US abington                  US        In-lab
##   anchor everest_feet everest_meters
## 1   high        30000             NA
## 2   high        30000             NA
## 3    low         5000             NA
## 4    low         2400             NA
## 5    low        10000             NA
## 6   high        25000             NA</code></pre>
<div id="missing-values" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Missing values<a href="the-one-sample-t-test.html#missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes a data set has missing values. In <code>R</code>, a missing value is shown as <code>NA</code> (for Not Available). For example, you can see missing values in the <code>everest_meters</code> variable. In this case, these are generally due to most participants being asked to judge the height of Mount Everest in feet, rather than meters.</p>
<p>If a variable has missing values, functions such as <code>mean</code> and <code>sd</code> will return a missing value, rather than a numeric value. For instance:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="the-one-sample-t-test.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anchoring<span class="sc">$</span>everest_meters)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="the-one-sample-t-test.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(anchoring<span class="sc">$</span>everest_meters)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>The reason for this is that when there are missing values, it is not possible to compute or estimate the mean or standard deviation from <em>all</em> the data. To compute the values for just the non-missing cases, you could first delete all cases with missing values from your <code>data.frame</code>, for instance with the <code>subset</code> function discussed later. But I think it is better to keep the dataset as is, and use other ways to avoid issues with missing values. Luckily, many functions have arguments to deal with missing values. For instance, the two functions above have an <code>na.rm</code> argument (for not-available-remove). Setting this to <code>TRUE</code> will call the function only on the non-missing-values:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="the-one-sample-t-test.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anchoring<span class="sc">$</span>everest_meters, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 6636.786</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="the-one-sample-t-test.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(anchoring<span class="sc">$</span>everest_meters, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 3942.714</code></pre>
<p>Because the default in these functions is to set <code>na.rm=FALSE</code>, you will be aware of missing values in your data, which is useful, although having to then to explicitly set <code>na.rm=TRUE</code> can be a little annoying.</p>
</div>
<div id="selecting-subsets-of-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Selecting subsets of data<a href="the-one-sample-t-test.html#selecting-subsets-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two main ways to select a subset of observations in base <code>R</code>. You can either use an “indexing variable”, or use the <code>subset</code> function. I will discuss both below.</p>
<div id="indexing-variables" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Indexing variables<a href="the-one-sample-t-test.html#indexing-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An indexing variable is used to specify the rows in a <code>data.frame</code> that you want to use. Generally, an indexing variable is a logical variable, which takes the value <code>TRUE</code> for cases (rows) that you want to include, and <code>FALSE</code> for cases that you want to exclude. Using an index variable, we will treat the <code>data.frame</code> as a matrix, which allows us to use square brackets, as in <code>data[row,column]</code> to either select rows or columns. For example, <code>anchoring[,"age"]</code> selects the column named “age” and returns it, while <code>anchoring[1:10,]</code> selects rows 1 to 10. The nice thing about R is that instead of providing row row numbers, we can create a logical variable based on the data itself to select rows. To do so, we can use the logical comparators and operators:</p>
<table>
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>“equal to”</td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td>“not equal to”</td>
</tr>
<tr class="odd">
<td><code>&gt;</code></td>
<td>“greater than”</td>
</tr>
<tr class="even">
<td><code>&gt;=</code></td>
<td>“greater than or equal to”</td>
</tr>
<tr class="odd">
<td><code>&lt;</code></td>
<td>“smaller than”</td>
</tr>
<tr class="even">
<td><code>&lt;=</code></td>
<td>“smaller than or equal to”</td>
</tr>
<tr class="odd">
<td><code>&amp;</code></td>
<td>“and”</td>
</tr>
<tr class="even">
<td><code>|</code></td>
<td>“or”</td>
</tr>
</tbody>
</table>
<p>Some examples of using index variables are as follows. An index variable which is <code>TRUE</code> for males and <code>FALSE</code> for females can be computed as follows:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="the-one-sample-t-test.html#cb114-1" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> anchoring<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span></span></code></pre></div>
<p>Let’s see what this variable looks like:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="the-one-sample-t-test.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(index)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE FALSE FALSE</code></pre>
<p>It is indeed a logical variable which is <code>TRUE</code> whenever <code>sex</code> is equal to <code>"m"</code>, and <code>FALSE</code> otherwise. You can use it to select all the males in the anchoring data by:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="the-one-sample-t-test.html#cb117-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> anchoring[index,]</span></code></pre></div>
<p>Note that you don’t have to create an index variable separately. You can obtain the same result by computing the index variable within the brackets, like so:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="the-one-sample-t-test.html#cb118-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> anchoring[anchoring<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>,]</span></code></pre></div>
<p>You can select all males over 30 years of age, and check the number of observations in this subset by the <code>nrow</code> function, as follows:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="the-one-sample-t-test.html#cb119-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> anchoring[anchoring<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> anchoring<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>,]</span>
<span id="cb119-2"><a href="the-one-sample-t-test.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dat)</span></code></pre></div>
<pre><code>## [1] 361</code></pre>
<p>You can select all participants who are male and over 30 years of age, or females who are female and over 30 years of age by:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="the-one-sample-t-test.html#cb121-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> anchoring[(anchoring<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> anchoring<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>) <span class="sc">|</span> (anchoring<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> anchoring<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>),]</span></code></pre></div>
</div>
<div id="the-subset-function" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> The <code>subset</code> function<a href="the-one-sample-t-test.html#the-subset-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The subset function is quite similar to using index variables, but it doesn’t require the treatment of the <code>data.frame</code> as a matrix and it looks for variable names in the <code>data.frame</code> so you don’t have to use e.g. <code>anchoring$</code> before the variable name. This makes the subset function a bit easier to use than using indexing variables. The <code>subset</code> function has the following arguments:
* <code>x</code>: the object (e.g. the <code>data.frame</code>) for which you want to select a subset of cases
* <code>subset</code>: a logical expression indicating elements or rows to keep
* <code>select</code>: an optional expression which indicates which columns to select from a data frame</p>
<p>I generally use just the first two arguments. We can replicate the selections above using the <code>subset</code> function as follows:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="the-one-sample-t-test.html#cb122-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(anchoring, sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb122-2"><a href="the-one-sample-t-test.html#cb122-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(anchoring, age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb122-3"><a href="the-one-sample-t-test.html#cb122-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(anchoring, (age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>) <span class="sc">|</span> (age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>))</span></code></pre></div>
<p>For more information on indexing and subsetting, have a look at e.g. <a href="http://www.cookbook-r.com/Basics/Getting_a_subset_of_a_data_structure/" class="uri">http://www.cookbook-r.com/Basics/Getting_a_subset_of_a_data_structure/</a></p>
<p>The data analysed in the SDAM book was selected as follows:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="the-one-sample-t-test.html#cb123-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(anchoring, anchor <span class="sc">==</span> <span class="st">&quot;low&quot;</span> <span class="sc">&amp;</span> (referrer <span class="sc">==</span> <span class="st">&quot;swps&quot;</span> <span class="sc">|</span> referrer <span class="sc">==</span> <span class="st">&quot;swpson&quot;</span>))</span></code></pre></div>
<p>Note the use of the brackets around the “or” argument. Here, we want to select those cases where the value of the <code>anchor</code> variable equals <code>"low"</code> and the value of the <code>referrer</code> variable equals <code>"swps"</code> or <code>"swpson"</code>. Combinations of logical statements with the <code>&amp;</code> operator evaluate to <code>TRUE</code> when the elements on the left and right of it are evaluated as <code>TRUE</code>. By placing brackets around <code>(referrer == "swps" | referrer == "swpson")</code>, this part is <code>TRUE</code> whenever the value of the <code>referrer</code> variable equals <code>"swps"</code> or <code>"swpson"</code>. Combining this with the left element, we then select those cases out of this subset for whom the <code>anchor</code> variable equals <code>"low"</code>. Another way to get the same result is as:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="the-one-sample-t-test.html#cb124-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(anchoring, (anchor <span class="sc">==</span> <span class="st">&quot;low&quot;</span> <span class="sc">&amp;</span> referrer <span class="sc">==</span> <span class="st">&quot;swps&quot;</span>) <span class="sc">|</span> (anchor <span class="sc">==</span> <span class="st">&quot;low&quot;</span> <span class="sc">&amp;</span> referrer <span class="sc">==</span> <span class="st">&quot;swpson&quot;</span>))</span></code></pre></div>
<p>Knowing how logical statements are evaluated in computer languages is very important. I won’t pretend this is easy at first. But with practice (and probably many mistakes, like I have made and sometimes still make), you will get an intuitive understanding of it. And when in doubt, check that the results are as you expected, by for instance first assigning the outcome of your expression to a new variable in your <code>data.frame</code> and then inspecting the values for errors. For example, you could use something like</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="the-one-sample-t-test.html#cb125-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> anchoring <span class="do">## assign a copy of the anchoring data to a &quot;throwaway object&quot;</span></span>
<span id="cb125-2"><a href="the-one-sample-t-test.html#cb125-2" aria-hidden="true" tabindex="-1"></a>tmp<span class="sc">$</span>selected <span class="ot">&lt;-</span> tmp<span class="sc">$</span>anchor <span class="sc">==</span> <span class="st">&quot;low&quot;</span> <span class="sc">&amp;</span> (tmp<span class="sc">$</span>referrer <span class="sc">==</span> <span class="st">&quot;swps&quot;</span> <span class="sc">|</span> tmp<span class="sc">$</span>referrer <span class="sc">==</span> <span class="st">&quot;swpson&quot;</span>)</span></code></pre></div>
<p>and then call</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="the-one-sample-t-test.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(tmp<span class="sc">$</span>anchor, tmp<span class="sc">$</span>referrer, tmp<span class="sc">$</span>selected)</span></code></pre></div>
<pre><code>##                FALSE TRUE
##                          
## high abington     38    0
##      brasilia     32    0
##      charles       5    0
##      ithaca       39    0
##      jmu          70    0
##      ku           39    0
##      laurier      37    0
##      lse         133    0
##      luc          67    0
##      mcdaniel     48    0
##      msvu         18    0
##      mturk       440    0
##      pi          386    0
##      psu          43    0
##      qccuny       46    0
##      qccuny2      38    0
##      sdsu         77    0
##      swps         18    0
##      swpson       65    0
##      tamu        100    0
##      tamuc        36    0
##      tamuon      101    0
##      tilburg      17    0
##      ufl          59    0
##      unipd        46    0
##      uva          35    0
##      vcu          49    0
##      wisc         44    0
##      wku          44    0
##      wl           41    0
##      wpi          34    0
## low  abington     35    0
##      brasilia     44    0
##      charles       3    0
##      ithaca       38    0
##      jmu          91    0
##      ku           36    0
##      laurier      48    0
##      lse         127    0
##      luc          69    0
##      mcdaniel     40    0
##      msvu         31    0
##      mturk       472    0
##      pi          370    0
##      psu          44    0
##      qccuny       47    0
##      qccuny2      39    0
##      sdsu         72    0
##      swps          0   36
##      swpson        0   73
##      tamu         76    0
##      tamuc        43    0
##      tamuon      102    0
##      tilburg      48    0
##      ufl          60    0
##      unipd        56    0
##      uva          41    0
##      vcu          51    0
##      wisc         47    0
##      wku          54    0
##      wl           45    0
##      wpi          49    0</code></pre>
<p>The <code>ftable</code> function is useful to obtain frequency tables in a slightly more readable format than through the <code>table</code> function. But as you can see, the output is still rather extensive. But we can clearly see that, as intended, the only cases for which the new <code>selected</code> variable is <code>TRUE</code> are all cases where <code>referrer</code> equals <code>"swps"</code> or <code>"swpson"</code>.</p>
</div>
</div>
<div id="one-sample-t-test" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> One-sample t-test<a href="the-one-sample-t-test.html#one-sample-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has a <code>t.test</code> function which allows you to compute a variety of t-tests. For a one-sample t-test, you would use the following arguments:</p>
<ul>
<li><code>x</code>: the variable for which to compute the t-test</li>
<li><code>mu</code>: the assumed value of the mean, i.e. <span class="math inline">\(\underline{\mu}\)</span></li>
<li><code>alternative</code>: similar as in <code>binom.test</code>, the range of values for <code>mu</code> (i.e. <span class="math inline">\(\mu\)</span>) considered in MODEL G. This must be either <code>two.sided</code> (all values allowed), <code>greater</code> (only values <span class="math inline">\(\mu &gt; \underline{\mu}\)</span> allowed), or <code>less</code> (only values <span class="math inline">\(\mu &lt; \underline{\mu}\)</span> allowed). The default value is <code>alternative = "two.sided"</code>.</li>
</ul>
<p>For instance, we can run the two-sided t-test also reported in the SDAM book by</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="the-one-sample-t-test.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dat<span class="sc">$</span>everest_meters, <span class="at">mu=</span><span class="dv">8848</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  dat$everest_meters
## t = -8.4429, df = 108, p-value = 1.558e-13
## alternative hypothesis: true mean is not equal to 8848
## 95 percent confidence interval:
##  5716.848 6907.537
## sample estimates:
## mean of x 
##  6312.193</code></pre>
<p>A one-sided test where MODEL R assumes <span class="math inline">\(\mu = 8848\)</span> and MODEL G assumes that <span class="math inline">\(\mu &lt; 8848\)</span>, is obtained by</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="the-one-sample-t-test.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dat<span class="sc">$</span>everest_meters, <span class="at">mu=</span><span class="dv">8848</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  dat$everest_meters
## t = -8.4429, df = 108, p-value = 7.791e-14
## alternative hypothesis: true mean is less than 8848
## 95 percent confidence interval:
##      -Inf 6810.498
## sample estimates:
## mean of x 
##  6312.193</code></pre>
</div>
<div id="effect-size" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Effect size<a href="the-one-sample-t-test.html#effect-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a one-sample t-test, the computation of Cohen’s <span class="math inline">\(d\)</span> is straightforward. You simply divide the difference between the mean and the assumed mean by the standard deviation:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="the-one-sample-t-test.html#cb132-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(dat<span class="sc">$</span>everest_meters) <span class="sc">-</span> <span class="dv">8848</span>)<span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>everest_meters)</span></code></pre></div>
<pre><code>## [1] -0.8086795</code></pre>
<p>Note the use of brackets around the difference between the sample mean and assumed mean. What we want to compute is
<span class="math display">\[\text{Cohen&#39;s } d = \frac{\overline{Y} - \underline{\mu}}{\sigma_Y}\]</span>
If I would have left the brackets out, R would compute the difference between the sample mean on the one hand, and the assumed mean divided by the standard deviation on the other hand:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="the-one-sample-t-test.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>everest_meters) <span class="sc">-</span> <span class="dv">8848</span><span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>everest_meters)</span></code></pre></div>
<pre><code>## [1] 6309.371</code></pre>
<p>which is
<span class="math display">\[\overline{Y} - \frac{\underline{\mu}}{\sigma_Y}\]</span>
and not what we intend to compute! Many errors are due to missing brackets.</p>
<p>If you don’t want to calculate Cohen’s <span class="math inline">\(d\)</span> in this way, you can also use the <code>cohens_d</code> function from the <code>effectsize</code> package <span class="citation">(<a href="#ref-R-effectsize" role="doc-biblioref">Ben-Shachar et al. 2022</a>)</span>, which provides functions for a wide variety of effect-size measures. You can supply a <code>t.test</code> directly as an argument to the <code>cohens_d</code> function:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="the-one-sample-t-test.html#cb136-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">cohens_d</span>(<span class="fu">t.test</span>(dat<span class="sc">$</span>everest_meters, <span class="at">mu=</span><span class="dv">8848</span>))</span></code></pre></div>
<pre><code>## Cohen&#39;s d |         95% CI
## --------------------------
## -0.81     | [-1.19, -0.59]
## 
## - Deviation from a difference of 8848.</code></pre>
<p>The output does not only provide the value of Cohen’s <span class="math inline">\(d\)</span> that we computed earlier, but also a confidence interval around this measure. In terms of the code, note that instead of first loading the <code>effectsize</code> package with <code>library(effectsize)</code>, I called the function directly by prepending the <code>cohens_d</code> function with the package name, as in <code>effectsize::cohens_d</code>. Calling functions in this way without loading the package first is handy, because some packages may use the same name for different functions. If that is the case, when you call a function with that name, you will get the function as implemented in the package you loaded the last. This often leads to errors. Where possible, it is best to avoid loading packages, and always use functions without first loading a package by prepending the name of the function with the package name.</p>
</div>
<div id="nonparametric-bootstrap" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Nonparametric bootstrap<a href="the-one-sample-t-test.html#nonparametric-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(This section is rather advanced and you can skip it for now if you want. You may want to return to this if you need or want to apply a bootstrapping technique.)</p>
<p>When discussing the Central Limit Theorem, I described how you can use <em>bootstrapping</em> to evaluate whether an assumed distribution for a statistic is likely to hold. Such a bootstrap analysis is quite easy to perform in R, although the idea itself is somewhat advanced. The key idea is to repeatedly sample, with replacement, from a given dataset, to obtain lots of new datasets, and then compute the statistic for those new dataset. To sample with replacement, the <code>sample</code> function in R comes in handy. In particular, you can use this function to sample the indices (from 1 to <span class="math inline">\(n\)</span>) of observations in a dataset. For example, if I have a dataset with 10 observations, I might sample with replacement numbers between 1 and 10 as follows:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="the-one-sample-t-test.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb138-2"><a href="the-one-sample-t-test.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] 10  6  5  9  5  6  4  2  7  6</code></pre>
<p>The first argument to the <code>sample</code> function is the set of elements you want to sample from (numbers in the sequence from 1 to 10 in this case), the second specifies the number of samples (10 in this case), and the third specifies that we sample with replacement, which means that we can sample the same element multiple times. Here, you can see that the number 3 occurs 3 times in our new sample, and the number 10 twice. If we then use these numbers to select observations in our dataset, the new dataset would replicate observation 3 three times, and observation 10 two times. Such replications of observations is exactly what we want in a nonparametric bootstrap. One way to get a bootstrap distribution of the sample mean, by sampling <code>nsim</code> new datasets of the same size as the original dataset (given as <span class="math inline">\(n\)</span>=<code>nrow(dat)</code>) would be as follows:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="the-one-sample-t-test.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23456</span>)</span>
<span id="cb140-2"><a href="the-one-sample-t-test.html#cb140-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span> <span class="co"># number of new datasets</span></span>
<span id="cb140-3"><a href="the-one-sample-t-test.html#cb140-3" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.0</span>,nsim) <span class="co"># initialize a vector to store the means in the new datasets</span></span>
<span id="cb140-4"><a href="the-one-sample-t-test.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) { <span class="co"># iterate for each bootstrap sample</span></span>
<span id="cb140-5"><a href="the-one-sample-t-test.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dat[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat),<span class="at">size=</span><span class="fu">nrow</span>(dat),<span class="at">replace=</span><span class="cn">TRUE</span>),]<span class="sc">$</span>everest_meters <span class="co"># sample data</span></span>
<span id="cb140-6"><a href="the-one-sample-t-test.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  boot_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="co"># compute mean and store it in an element of boot_mean</span></span>
<span id="cb140-7"><a href="the-one-sample-t-test.html#cb140-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>R is rather slow in performing <code>for</code> loops. It is more efficient to generate all the <code>y</code> samples for all simulations in one go. Instead of repeatedly sampling <code>size=nrow(dat)</code> samples, we can sample the indices for all bootstrap samples in one go as <code>size=nsim*nrow(dat)</code>. If we then place the sampled <code>y</code> values in a matrix, we can compute the mean for each column in that matrix to get our <code>boot_mean</code> variable. This is how I performed the bootstrapped distribution of the sample mean:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="the-one-sample-t-test.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23456</span>)</span>
<span id="cb141-2"><a href="the-one-sample-t-test.html#cb141-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span> <span class="co"># number of new datasets</span></span>
<span id="cb141-3"><a href="the-one-sample-t-test.html#cb141-3" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.0</span>,nsim) <span class="co"># initialize a vector to store the means in the new datasets</span></span>
<span id="cb141-4"><a href="the-one-sample-t-test.html#cb141-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(dat[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat),<span class="at">size=</span>nsim<span class="sc">*</span><span class="fu">nrow</span>(dat),<span class="at">replace=</span><span class="cn">TRUE</span>),]<span class="sc">$</span>everest_meters,<span class="at">ncol=</span>nsim)</span>
<span id="cb141-5"><a href="the-one-sample-t-test.html#cb141-5" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(y)</span></code></pre></div>
<p>I then plotted the histogram with the overlaid theoretical distribution as follows:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="the-one-sample-t-test.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">mean=</span>boot_mean), <span class="fu">aes</span>(<span class="at">x=</span>mean)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb142-2"><a href="the-one-sample-t-test.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(boot_mean), <span class="at">sd =</span> <span class="fu">sd</span>(boot_mean)) <span class="sc">*</span> <span class="dv">30</span> <span class="sc">*</span> nsim, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<p><img src="03-GLM-simple_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Note the use of the <code>stat_function</code> in which I supplied a function to compute the Normal density function with a mean and standard deviation equal to those of the <code>boot_mean</code> variable. This then plots the density of that variable, assuming it follows a Normal distribution. We can also plot the Q-Q plot as follows:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="the-one-sample-t-test.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">mean=</span>boot_mean), <span class="fu">aes</span>(<span class="at">sample =</span> mean)) <span class="sc">+</span> <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;sample&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;theoretical&quot;</span>)</span></code></pre></div>
<p><img src="03-GLM-simple_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>To get a bootstrapped distribution of the <span class="math inline">\(t\)</span>-statistic, we can follow a mostly similar procedure. In this case, we want to determine the distribution of the <span class="math inline">\(t\)</span>-statistic assuming that the null-hypothesis is true. To get this, rather than testing against <span class="math inline">\(\underline{\mu} - 8848\)</span>, we set <span class="math inline">\(\underline{\mu} = \overline{Y}\)</span> here. The reasoning behind this is that <span class="math inline">\(\overline{Y}\)</span> is our best estimate of <span class="math inline">\(\mu\)</span>, whilst the assumed value <span class="math inline">\(\underline{\mu}\)</span> might be completely wrong. If the distribution of the <span class="math inline">\(t\)</span>-statistic with our best guess <span class="math inline">\(\underline{\mu} = \overline{Y}\)</span> follows a t-distribution, we could assume it would also follow a t-distribution if the null-hypothesis were true. The code to get the bootstrapped distribution of the <span class="math inline">\(t\)</span>-statistic is:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="the-one-sample-t-test.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23456</span>)</span>
<span id="cb144-2"><a href="the-one-sample-t-test.html#cb144-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span> <span class="co"># number of new datasets</span></span>
<span id="cb144-3"><a href="the-one-sample-t-test.html#cb144-3" aria-hidden="true" tabindex="-1"></a>boot_t <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.0</span>,nsim)</span>
<span id="cb144-4"><a href="the-one-sample-t-test.html#cb144-4" aria-hidden="true" tabindex="-1"></a>s_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>everest_meters)</span>
<span id="cb144-5"><a href="the-one-sample-t-test.html#cb144-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(dat[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat),<span class="at">size=</span>nsim<span class="sc">*</span><span class="fu">nrow</span>(dat),<span class="at">replace=</span><span class="cn">TRUE</span>),]<span class="sc">$</span>everest_meters,<span class="at">ncol=</span>nsim)</span>
<span id="cb144-6"><a href="the-one-sample-t-test.html#cb144-6" aria-hidden="true" tabindex="-1"></a>boot_t <span class="ot">&lt;-</span> <span class="fu">apply</span>(y, <span class="at">MARGIN=</span><span class="dv">2</span>, <span class="at">FUN=</span><span class="cf">function</span>(x) <span class="fu">t.test</span>(x, <span class="at">mu=</span>s_mean)<span class="sc">$</span>statistic)</span></code></pre></div>
<p>Note the use of the <code>apply</code> function on the last line. The <code>apply</code> function can be used to apply any function provided in the <code>FUN</code> argument over a particular (set) of dimensions in an array. In this case, <code>y</code> is a matrix, and specifying <code>MARGIN=2</code> means that we apply the function over each column in that matrix (setting the argument to <code>MARGIN=1</code> would apply the function to each row in the matrix). The function that we apply to each column of <code>y</code> (which is each bootstrapped sample) is the <code>t.test</code> function, and we only store the value of the <code>statistic</code> variable of the output of that function (which is the value of the <span class="math inline">\(t\)</span>-statistic).</p>
<p>We can plot the bootstrap distribution with the theoretical distribution overlaid as follows:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="the-one-sample-t-test.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">t=</span>boot_t), <span class="fu">aes</span>(<span class="at">x=</span>t)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb145-2"><a href="the-one-sample-t-test.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="fu">nrow</span>(dat) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> .<span class="dv">1</span> <span class="sc">*</span> nsim, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<p><img src="03-GLM-simple_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>and the Q-Q plot as:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="the-one-sample-t-test.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">t=</span>boot_t), <span class="fu">aes</span>(<span class="at">sample =</span> t)) <span class="sc">+</span> <span class="fu">stat_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qt, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="fu">nrow</span>(dat) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb146-2"><a href="the-one-sample-t-test.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qt, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="fu">nrow</span>(dat) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;sample&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;theoretical&quot;</span>)</span></code></pre></div>
<p><img src="03-GLM-simple_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-effectsize" class="csl-entry">
Ben-Shachar, Mattan S., Dominique Makowski, Daniel Lüdecke, Indrajeet Patil, and Brenton M. Wiernik. 2022. <em>Effectsize: Indices of Effect Size</em>. <a href="https://easystats.github.io/effectsize/">https://easystats.github.io/effectsize/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-modelling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"source": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
