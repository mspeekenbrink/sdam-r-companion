<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Regression | An R companion to Statistics: data analysis and modelling</title>
  <meta name="description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Regression | An R companion to Statistics: data analysis and modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="github-repo" content="mspeekenbrink/sdam-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Regression | An R companion to Statistics: data analysis and modelling" />
  
  <meta name="twitter:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  

<meta name="author" content="Maarten Speekenbrink" />


<meta name="date" content="2021-12-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-one-sample-t-test.html"/>
<link rel="next" href="moderation-and-mediation.html"/>
<script src="book_assets/header-attrs-2.11/header-attrs.js"></script>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#download-r"><i class="fa fa-check"></i><b>1.2.1</b> Download R</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#download-r-studio"><i class="fa fa-check"></i><b>1.2.2</b> Download R Studio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#working-with-rstudio"><i class="fa fa-check"></i><b>1.3</b> Working with RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing packages</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#installing-the-sdamr-package"><i class="fa fa-check"></i><b>1.4.1</b> Installing the <code>sdamr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.5</b> Getting help</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#first-steps-r-as-a-calculator"><i class="fa fa-check"></i><b>1.6</b> First steps: R as a calculator</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#data"><i class="fa fa-check"></i><b>1.7</b> Data</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.7.1</b> Data types</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction.html"><a href="introduction.html#objects"><i class="fa fa-check"></i><b>1.7.2</b> Objects</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction.html"><a href="introduction.html#importing-data"><i class="fa fa-check"></i><b>1.7.3</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#exploring-data-descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Exploring data: Descriptive statistics</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#exploring-data-creating-plots"><i class="fa fa-check"></i><b>1.9</b> Exploring data: Creating plots</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#histogram"><i class="fa fa-check"></i><b>1.9.1</b> Histogram</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#boxplot"><i class="fa fa-check"></i><b>1.9.2</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#scatterplot"><i class="fa fa-check"></i><b>1.10</b> Scatterplot</a></li>
<li class="chapter" data-level="1.11" data-path="introduction.html"><a href="introduction.html#raincloud-plot"><i class="fa fa-check"></i><b>1.11</b> Raincloud plot</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-modelling.html"><a href="statistical-modelling.html"><i class="fa fa-check"></i><b>2</b> Statistical modelling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#distributions"><i class="fa fa-check"></i><b>2.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#generating-random-data"><i class="fa fa-check"></i><b>2.1.1</b> Generating random data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#estimation"><i class="fa fa-check"></i><b>2.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#the-likelihood-function"><i class="fa fa-check"></i><b>2.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#calculating-the-likelihood-ratio"><i class="fa fa-check"></i><b>2.2.2</b> Calculating the likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-modelling.html"><a href="statistical-modelling.html#hypothesis-testing-directly-with-the-binomial-distribution"><i class="fa fa-check"></i><b>2.3</b> Hypothesis testing directly with the binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html"><i class="fa fa-check"></i><b>3</b> The one-sample t-test</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#missing-values"><i class="fa fa-check"></i><b>3.1</b> Missing values</a></li>
<li class="chapter" data-level="3.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#selecting-subsets-of-data"><i class="fa fa-check"></i><b>3.2</b> Selecting subsets of data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#indexing-variables"><i class="fa fa-check"></i><b>3.2.1</b> Indexing variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#the-subset-function"><i class="fa fa-check"></i><b>3.2.2</b> The <code>subset</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> One-sample t-test</a></li>
<li class="chapter" data-level="3.4" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#effect-size"><i class="fa fa-check"></i><b>3.4</b> Effect size</a></li>
<li class="chapter" data-level="3.5" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#nonparametric-bootstrap"><i class="fa fa-check"></i><b>3.5</b> Nonparametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>4</b> Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression.html"><a href="regression.html#estimating-an-testing-a-simple-regression-model"><i class="fa fa-check"></i><b>4.1</b> Estimating an testing a simple regression model</a></li>
<li class="chapter" data-level="4.2" data-path="regression.html"><a href="regression.html#model-comparisons"><i class="fa fa-check"></i><b>4.2</b> Model comparisons</a></li>
<li class="chapter" data-level="4.3" data-path="regression.html"><a href="regression.html#estimating-and-testing-a-multiple-regression-model"><i class="fa fa-check"></i><b>4.3</b> Estimating and testing a multiple regression model</a></li>
<li class="chapter" data-level="4.4" data-path="regression.html"><a href="regression.html#residuals-and-predicted-values"><i class="fa fa-check"></i><b>4.4</b> Residuals and predicted values</a></li>
<li class="chapter" data-level="4.5" data-path="regression.html"><a href="regression.html#plotting-pairwise-scatterplots-for-many-variables"><i class="fa fa-check"></i><b>4.5</b> Plotting pairwise scatterplots for many variables</a></li>
<li class="chapter" data-level="4.6" data-path="regression.html"><a href="regression.html#multicollinearity-and-outlier-detection"><i class="fa fa-check"></i><b>4.6</b> Multicollinearity and outlier detection</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html"><i class="fa fa-check"></i><b>5</b> Moderation and mediation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#moderation-in-linear-models"><i class="fa fa-check"></i><b>5.1</b> Moderation in linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#a-bit-about-namespaces"><i class="fa fa-check"></i><b>5.1.1</b> A bit about namespaces</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#centering"><i class="fa fa-check"></i><b>5.2</b> Centering</a></li>
<li class="chapter" data-level="5.3" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#mediation-analysis"><i class="fa fa-check"></i><b>5.3</b> Mediation analysis</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#causal-steps"><i class="fa fa-check"></i><b>5.3.1</b> Causal steps</a></li>
<li class="chapter" data-level="5.3.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#investigating-the-moderated-indirect-effect-with-a-bootstrap-test"><i class="fa fa-check"></i><b>5.3.2</b> Investigating the moderated (indirect) effect with a bootstrap test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html"><i class="fa fa-check"></i><b>6</b> Contrast coding and oneway ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#computing-contrast-coded-predictors"><i class="fa fa-check"></i><b>6.1</b> Computing contrast-coded predictors</a></li>
<li class="chapter" data-level="6.2" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#assigning-contrasts-to-factors"><i class="fa fa-check"></i><b>6.2</b> Assigning contrasts to factors</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#default-coding-schemes"><i class="fa fa-check"></i><b>6.2.1</b> Default coding schemes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="factorial-anova.html"><a href="factorial-anova.html"><i class="fa fa-check"></i><b>7</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="factorial-anova.html"><a href="factorial-anova.html#rainclouds-for-factorial-designs"><i class="fa fa-check"></i><b>7.1</b> Rainclouds for factorial designs</a></li>
<li class="chapter" data-level="7.2" data-path="factorial-anova.html"><a href="factorial-anova.html#formulating-estimating-and-testing-a-factorial-anova"><i class="fa fa-check"></i><b>7.2</b> Formulating, estimating, and testing a factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="factorial-anova.html"><a href="factorial-anova.html#a-threeway-anova"><i class="fa fa-check"></i><b>7.2.1</b> A threeway ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="factorial-anova.html"><a href="factorial-anova.html#type-1-2-and-3-sums-of-squares"><i class="fa fa-check"></i><b>7.3</b> Type 1, 2, and 3 Sums of Squares</a></li>
<li class="chapter" data-level="7.4" data-path="factorial-anova.html"><a href="factorial-anova.html#planned-comparisons-and-post-hoc-tests-with-emmeans"><i class="fa fa-check"></i><b>7.4</b> Planned comparisons and post-hoc tests with <code>emmeans</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="factorial-anova.html"><a href="factorial-anova.html#adjusted-p-values"><i class="fa fa-check"></i><b>7.4.1</b> Adjusted p-values</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="factorial-anova.html"><a href="factorial-anova.html#testing-general-contrasts-with-emmeans"><i class="fa fa-check"></i><b>7.5</b> Testing general contrasts with <code>emmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>8</b> Repeated-measures ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#long-and-wide-data"><i class="fa fa-check"></i><b>8.1</b> Long and wide data</a></li>
<li class="chapter" data-level="8.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-separate-glms"><i class="fa fa-check"></i><b>8.2</b> Repeated-measures ANOVA with separate GLMs</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#computing-within-subjects-composite-scores"><i class="fa fa-check"></i><b>8.2.1</b> Computing within-subjects composite scores</a></li>
<li class="chapter" data-level="8.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#performing-a-repeated-measures-anova-with-separate-models"><i class="fa fa-check"></i><b>8.2.2</b> Performing a repeated-measures ANOVA with separate models</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-car-package"><i class="fa fa-check"></i><b>8.3</b> Repeated-measures ANOVA with the <code>car</code> package</a></li>
<li class="chapter" data-level="8.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-afex-package"><i class="fa fa-check"></i><b>8.4</b> Repeated-measures ANOVA with the <code>afex</code> package</a></li>
<li class="chapter" data-level="8.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#contrasts-with-the-emmeans-package"><i class="fa fa-check"></i><b>8.5</b> Contrasts with the <code>emmeans</code> package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>9</b> Linear mixed-effects models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#formulating-and-estimating-linear-mixed-effects-models-with-lme4"><i class="fa fa-check"></i><b>9.1</b> Formulating and estimating linear mixed-effects models with <code>lme4</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-model"><i class="fa fa-check"></i><b>9.1.1</b> Random intercepts model</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#visually-assessing-model-assumptions"><i class="fa fa-check"></i><b>9.1.2</b> Visually assessing model assumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-and-slopes"><i class="fa fa-check"></i><b>9.1.3</b> Random intercepts and slopes</a></li>
<li class="chapter" data-level="9.1.4" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#likelihood-ratio-test-with-the-anova-function"><i class="fa fa-check"></i><b>9.1.4</b> Likelihood ratio test with the <code>anova</code> function</a></li>
<li class="chapter" data-level="9.1.5" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.1.6" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#plotting-model-predictions"><i class="fa fa-check"></i><b>9.1.6</b> Plotting model predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#obtaining-p-values-with-afexmixed"><i class="fa fa-check"></i><b>9.2</b> Obtaining p-values with <code>afex::mixed</code></a></li>
<li class="chapter" data-level="9.3" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#crossed-random-effects"><i class="fa fa-check"></i><b>9.3</b> Crossed random effects</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html"><i class="fa fa-check"></i><b>10</b> Bayesian hypothesis testing through Bayes Factors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#the-bayesfactor-package"><i class="fa fa-check"></i><b>10.1</b> The <code>BayesFactor</code> package</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-one-sample-t-test"><i class="fa fa-check"></i><b>10.1.1</b> A Bayesian one-sample t-test</a></li>
<li class="chapter" data-level="10.1.2" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-two-sample-t-test"><i class="fa fa-check"></i><b>10.1.2</b> A Bayesian two-sample t-test</a></li>
<li class="chapter" data-level="10.1.3" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-anova"><i class="fa fa-check"></i><b>10.1.3</b> A Bayesian ANOVA</a></li>
<li class="chapter" data-level="10.1.4" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#bayesian-regression-and-ancova"><i class="fa fa-check"></i><b>10.1.4</b> Bayesian regression and ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html"><i class="fa fa-check"></i><b>11</b> Reproducible reports with RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#yaml-headers"><i class="fa fa-check"></i><b>11.1</b> YAML headers</a></li>
<li class="chapter" data-level="11.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#markdown-syntax"><i class="fa fa-check"></i><b>11.2</b> Markdown syntax</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#inline-formatting"><i class="fa fa-check"></i><b>11.2.1</b> Inline formatting</a></li>
<li class="chapter" data-level="11.2.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#block-level-elements"><i class="fa fa-check"></i><b>11.2.2</b> Block-level elements</a></li>
<li class="chapter" data-level="11.2.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#math-expressions"><i class="fa fa-check"></i><b>11.2.3</b> Math expressions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#r-code"><i class="fa fa-check"></i><b>11.3</b> R code chunks and inline R code</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#figures"><i class="fa fa-check"></i><b>11.3.1</b> Figures</a></li>
<li class="chapter" data-level="11.3.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#tables"><i class="fa fa-check"></i><b>11.3.2</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#apa-documents-with-papaja"><i class="fa fa-check"></i><b>11.4</b> APA documents with <code>papaja</code></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#installation"><i class="fa fa-check"></i><b>11.4.1</b> Installation</a></li>
<li class="chapter" data-level="11.4.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#how-to-use-papaja"><i class="fa fa-check"></i><b>11.4.2</b> How to use papaja</a></li>
<li class="chapter" data-level="11.4.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#getting-help-1"><i class="fa fa-check"></i><b>11.4.3</b> Getting help</a></li>
<li class="chapter" data-level="11.4.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#other-related-r-packages"><i class="fa fa-check"></i><b>11.4.4</b> Other related R packages</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R companion to Statistics: data analysis and modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Regression</h1>
<div id="estimating-an-testing-a-simple-regression-model" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Estimating an testing a simple regression model</h2>
<p>Regression analysis is done through the <code>lm</code> function, with the following syntax: <code>lm(formula, data,...)</code>. The first argument is called <code>formula</code> and expects a symbolic description of your model. I will tell you more about how to specify models with the formula syntax later, when we discuss moderation. For now, a few simple examples will suffice. To specify a simple regression model where you predict a dependent variable <code>y</code> by a predictor <code>x</code>, you would use the formula</p>
<p><code>y ~ x</code></p>
<p>On the left-hand side of the formula you need to provide the name of the dependent variable. After the name of the dependent variable, you need to put a tilde (<code>~</code>) (which you can read is “is modelled as a function of”). On the right-hand side, you then provide the name of the predictor. R will automatically include an intercept in the model. In R, the intercept is actually represented as a special predictor which always (for every row in the data set) has the value 1. The formula above is actually interpreted as
<code>y ~ x + 1</code></p>
<p>Because the intercept is included in most models, the authors of R have decided to save the you trouble of typing <code>+ 1</code> in each formula, by making this part of the formula implicit. You can fit a model without an intercept (which is the same as fixing the value of the intercept to 0), by instead of <code>+ 1</code>, putting <code>- 1</code> in the formula, as in</p>
<p><code>y ~ x - 1</code></p>
<p>The second argument of the <code>lm</code> function is called <code>data</code> and expects the name of the data.frame in which the variables are stored.</p>
<p>To see how the <code>lm</code> function works in practice, let’s open the <code>trump2016</code> data provided in the <code>sdamr</code> package. This is the data analysed in Chapter 4 and 5. We open and inspect the data as usual:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="regression.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb141-2"><a href="regression.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load the Trump data</span></span>
<span id="cb141-3"><a href="regression.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;trump2016&quot;</span>)</span>
<span id="cb141-4"><a href="regression.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the data from the District of Columbia (Washintgon D.C.)</span></span>
<span id="cb141-5"><a href="regression.html#cb141-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(trump2016,state <span class="sc">!=</span> <span class="st">&quot;District of Columbia&quot;</span>)</span>
<span id="cb141-6"><a href="regression.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##        state hate_groups population hate_groups_per_million
## 1    Alabama          27    4863300                    5.55
## 2     Alaska           0     741894                    0.00
## 3    Arizona          18    6931071                    2.60
## 4   Arkansas          16    2988248                    5.35
## 5 California          79   39250017                    2.01
## 6   Colorado          16    5540545                    2.89
##   percent_bachelors_degree_or_higher percent_in_poverty percent_Trump_votes
## 1                               15.4               18.5                62.9
## 2                               29.7               10.4                52.9
## 3                               27.7               17.4                49.5
## 4                               21.8               18.7                60.4
## 5                               32.3               15.4                32.7
## 6                               39.2               11.5                44.4</code></pre>
<p>You can see that there are a number of variables in the dataset (and not all of these were analysed in the book). For more information on the variables in the dataset, you can call the help file with <code>?trump2016</code>.</p>
<p>Now let’s estimate a simple regression model to predict the percentage of votes for Trump by the number of hate groups per million citizens:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="regression.html#cb143-1" aria-hidden="true" tabindex="-1"></a>modg <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> hate_groups_per_million, <span class="at">data=</span>dat)</span>
<span id="cb143-2"><a href="regression.html#cb143-2" aria-hidden="true" tabindex="-1"></a>modg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = percent_Trump_votes ~ hate_groups_per_million, data = dat)
## 
## Coefficients:
##             (Intercept)  hate_groups_per_million  
##                    42.9                      2.3</code></pre>
<p>I’ve named the resulting object <code>modg</code> for MODEL G. You can pick any name you like for R objects. Note that when you just print a fitted linear model (by e.g., typing the name of the object <code>modg</code>), R will show the parameter estimates, but nothing else. You can get the important statistics by calling the <code>summary</code> function on the fitted model:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="regression.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = percent_Trump_votes ~ hate_groups_per_million, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.8206  -5.8570  -0.0529   5.2632  20.7883 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              42.8968     2.4094  17.804  &lt; 2e-16 ***
## hate_groups_per_million   2.3004     0.6715   3.426  0.00127 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.142 on 48 degrees of freedom
## Multiple R-squared:  0.1965, Adjusted R-squared:  0.1797 
## F-statistic: 11.74 on 1 and 48 DF,  p-value: 0.001265</code></pre>
<p>This provides quite a lot of useful information. The output of the <code>summary</code> function consists of four parts:</p>
<ul>
<li><code>Call</code> simply shows you the call to the <code>lm</code> function used to fit the model (including the model formula)</li>
<li><code>Residuals</code> shows you some summary statistics for the prediction errors of the estimated model (which are often referred to as residuals)</li>
<li><code>Coefficients</code> shows you a table with:
<ul>
<li>the name of variable for which the parameter was estimated</li>
<li><code>Estimate</code>: the estimated parameters</li>
<li><code>Std. Error</code>: the standard error of the estimates (this is the standard deviation of the sampling distribution of the estimates)</li>
<li><code>t value</code>: the t statistic of the hypothesis test that the true value of the parameter is equal to 0.</li>
<li><code>Pr(&gt;|t|)</code>: the p-value, which is the probability that, given that the null hypothesis is true (i.e. the true value of the parameter is equal to 0), you would find a t-statistic at least as extreme as the one computed found for this data.</li>
</ul></li>
<li>Some overall model statistics:
<ul>
<li><code>Residual standard error</code>: this is and unbiased estimate of the standard deviation of the errors.</li>
<li><code>Multiple R-squared:</code> the <span class="math inline">\(R^2\)</span> or proportion of variance of the dependent variable “explained” by the model.</li>
<li><code>Adjusted R-squared</code>: an unbiased estimate of the true value of <span class="math inline">\(R^2\)</span></li>
<li><code>F-statistic</code>: the results of a model comparison comparing the estimated model (MODEL G) to a MODEL R which only includes an intercept.</li>
</ul></li>
</ul>
</div>
<div id="model-comparisons" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Model comparisons</h2>
<p>Comparing regression models and computing the <span class="math inline">\(F\)</span> statistic can be done through the <code>anova()</code> function. Let’s first estimate a restricted version of MODEL G above where we fix the slope of <code>hate_groups_per_million</code> to 0. This MODEL R is identical to a model with only an intercept. We can estimate this by not providing any predictor names, but now explicitly providing the intercept term <code>1</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="regression.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a MODEL R with only an intercept</span></span>
<span id="cb147-2"><a href="regression.html#cb147-2" aria-hidden="true" tabindex="-1"></a>modr <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>dat)</span></code></pre></div>
<p>We can then compute the <span class="math inline">\(F\)</span> test by entering this MODEL R, and the MODEL G we estimated earlier, as arguments in the <code>anova</code> function:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="regression.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modr,modg)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: percent_Trump_votes ~ 1
## Model 2: percent_Trump_votes ~ hate_groups_per_million
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1     49 4992.2                                
## 2     48 4011.4  1    980.78 11.736 0.001265 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>the output lists the formula’s of the models we compare, and then provides a table with test results. The columns in this table are
* <code>Res.Df</code>: the denominator degrees of freedom, i.e. <span class="math inline">\(n=-\text{npar}(M)\)</span>
* <code>RSS</code>: the “residual sum of squares” or Sum of Squared Error of the model, i.e. <span class="math inline">\(\text{SSE}(M)\)</span>
* <code>Df</code>: the numerator degrees of freedom,,i.e. $(G) - (R)
* <code>Sum of Sq</code>: the reduction in the Sum of Squared Error, i.e. <span class="math inline">\(\text{SSE}(R) - \text{SSE}(R)\)</span>
* <code>F</code>: the <span class="math inline">\(F\)</span> statistic of the test
* <code>Pr(&gt;F)</code>: the p-value of the test.</p>
<p>We can obtain a test for the intercept by fitting a different MODEL R, now without an intercept, and comparing it to MODEL G</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="regression.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a MODEL R without an intercept (through &quot; - 1&quot;)</span></span>
<span id="cb150-2"><a href="regression.html#cb150-2" aria-hidden="true" tabindex="-1"></a>modr <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> hate_groups_per_million <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data=</span>dat)</span>
<span id="cb150-3"><a href="regression.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modr,modg)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: percent_Trump_votes ~ hate_groups_per_million - 1
## Model 2: percent_Trump_votes ~ hate_groups_per_million
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     49 30501.7                                  
## 2     48  4011.4  1     26490 316.98 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The output of the <code>anova</code> function isn’t particularly pretty. Also, if you want to do multiple model comparisons, first estimating models and then comparing them with the <code>anova</code> function becomes a little cumbersome. An easier way to obtain all the model comparisons is to use the <code>Anova</code> function from the <code>car</code> <span class="citation">(<a href="#ref-R-car" role="doc-biblioref">Fox, Weisberg, and Price 2021</a>)</span> package to automatically construct different possible versions of MODEL R, each being one particular restriction of MODEL G which fixes the relevant parameter to 0. If you don’t have the <code>car</code> package installed yet, you need to install it first (e.g. by <code>install.packages("car")</code>. You can then call:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="regression.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb152-2"><a href="regression.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(modg, <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: percent_Trump_votes
##                          Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)             26490.3  1 316.981 &lt; 2.2e-16 ***
## hate_groups_per_million   980.8  1  11.736  0.001265 ** 
## Residuals                4011.4 48                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that it is important to give the <code>type = 3</code> argument in the <code>Anova</code> function. This will construct MODEL R by fixing a single parameter to 0 in turn (i.e. first fixing <span class="math inline">\(\beta_0=0\)</span> and estimating all other parameters, then another model fixing <span class="math inline">\(\beta_1 = 0\)</span> for estimating all other parameters), etc.</p>
</div>
<div id="estimating-and-testing-a-multiple-regression-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Estimating and testing a multiple regression model</h2>
<p>To specify a multiple regression model for a dependent variable named <code>y</code> and with three predictors, named <code>x1</code>, <code>x2</code>, and <code>x3</code>, you would use the formula</p>
<p><code>y ~ x1 + x2 + x3</code></p>
<p>This is similar to the earlier formula, but you now need to provide the names of all the predictors, separated by a <code>+</code> sign.</p>
<p>For instance, we can fit a model with two predictors (which we will call <code>modg</code>, for MODEL G), as follows:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="regression.html#cb154-1" aria-hidden="true" tabindex="-1"></a>modg <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> hate_groups_per_million <span class="sc">+</span> percent_bachelors_degree_or_higher, <span class="at">data=</span>dat)</span>
<span id="cb154-2"><a href="regression.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = percent_Trump_votes ~ hate_groups_per_million + 
##     percent_bachelors_degree_or_higher, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.7268  -4.0621   0.0426   2.8937  15.8359 
## 
## Coefficients:
##                                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                         81.9945     6.1555  13.321  &lt; 2e-16 ***
## hate_groups_per_million              1.3138     0.5102   2.575   0.0132 *  
## percent_bachelors_degree_or_higher  -1.2187     0.1839  -6.625 3.03e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.643 on 47 degrees of freedom
## Multiple R-squared:  0.5845, Adjusted R-squared:  0.5668 
## F-statistic: 33.06 on 2 and 47 DF,  p-value: 1.087e-09</code></pre>
<p>the output of the summary function contains the same elements as before, but the table of coefficients now includes an additional row for <code>percent_bachelors_degree_or_higher</code>. Also, note that all the estimates are different, because the slopes reflect unique effects, and these differ compared to models with other predictors. Finally, I’d like to point out that the last row of the output contains the “whole model test,” which compares the estimated model to a model with only an intercept. Recall that the estimate of the intercept in this latter model equals the sample mean. So we are now comparing a model with two predictors to a model which predicts all values as the sample mean. The difference in the number of estimated parameters for this comparison is <span class="math inline">\(\text{npar}(G) - \text{npar}(R) = 3 - 1 = 2\)</span>. Hence, the degrees of freedom are <span class="math inline">\(\text{df}_1 = 2\)</span> and <span class="math inline">\(\text{df}_2 = n - \text{npar}(G) = 50 - 3 = 47\)</span>.</p>
<p>We can also get all the model comparisons for this MODEL G through:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="regression.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(modg, <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: percent_Trump_votes
##                                    Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)                        7830.7  1 177.4381 &lt; 2.2e-16 ***
## hate_groups_per_million             292.7  1   6.6318   0.01322 *  
## percent_bachelors_degree_or_higher 1937.2  1  43.8956 3.028e-08 ***
## Residuals                          2074.2 47                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Finally, we can also obtain a “whole model test,” by comparing an intercept-only MODEL R to the full MODEL G. This is best done through the <code>anova</code> function as follows:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="regression.html#cb158-1" aria-hidden="true" tabindex="-1"></a>modr <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>dat)</span>
<span id="cb158-2"><a href="regression.html#cb158-2" aria-hidden="true" tabindex="-1"></a>modg <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> hate_groups_per_million <span class="sc">+</span> percent_bachelors_degree_or_higher, <span class="at">data=</span>dat)</span>
<span id="cb158-3"><a href="regression.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modr,modg)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: percent_Trump_votes ~ 1
## Model 2: percent_Trump_votes ~ hate_groups_per_million + percent_bachelors_degree_or_higher
##   Res.Df    RSS Df Sum of Sq     F    Pr(&gt;F)    
## 1     49 4992.2                                 
## 2     47 2074.2  2      2918 33.06 1.087e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="residuals-and-predicted-values" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Residuals and predicted values</h2>
<p>You can obtain the prediction errors by the calling the <code>residuals</code> function on the fitted model.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="regression.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the residuals as errorg</span></span>
<span id="cb160-2"><a href="regression.html#cb160-2" aria-hidden="true" tabindex="-1"></a>errorg <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modg)</span>
<span id="cb160-3"><a href="regression.html#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(errorg)</span></code></pre></div>
<pre><code>##          1          2          3          4          5          6 
##  -7.618118   7.101376  -2.152059  -2.055564 -12.570794   6.382163</code></pre>
<p>This returns a vector with, for each case in the data (each row in the data frame), the error term <span class="math inline">\(\hat{\epsilon}_i\)</span>. Note that we are only displaying the first six elements through the <code>head</code> function.</p>
<p>You can obtain the predicted values by calling the <code>predict</code> function on the fitted model.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="regression.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the predictions as predictg</span></span>
<span id="cb162-2"><a href="regression.html#cb162-2" aria-hidden="true" tabindex="-1"></a>predictg <span class="ot">&lt;-</span> <span class="fu">predict</span>(modg)</span>
<span id="cb162-3"><a href="regression.html#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predictg)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 70.51812 45.79862 51.65206 62.45556 45.27079 38.01784</code></pre>
<p>This returns a vector with for, each case in the data, the predicted value <span class="math inline">\(\hat{Y}_{M,i}\)</span>. You can use these variables to create e.g. a histogram of the errors:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="regression.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(errorg)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.svg" width="672" style="display: block; margin: auto;" />
and a predicted by residual plot</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="regression.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot of predicted vs residual</span></span>
<span id="cb165-2"><a href="regression.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predictg, errorg, <span class="at">xlab =</span> <span class="st">&quot;predicted&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb165-3"><a href="regression.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add a horizontal line (h=0 is for horizontal at 0, </span></span>
<span id="cb165-4"><a href="regression.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and lty = 3 makes it a dotted line </span></span>
<span id="cb165-5"><a href="regression.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-100-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>You can also call the plot function directly on the fitted model, which produces a range of plots to assess the model assumptions:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="regression.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modg)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.svg" width="672" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-101-2.svg" width="672" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-101-3.svg" width="672" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-101-4.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-pairwise-scatterplots-for-many-variables" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Plotting pairwise scatterplots for many variables</h2>
<p>A final tip relates to exploring relations between many variables (e.g. potential predictors and dependent variables). While you can inspect pairwise relations between variables by creating a scatterplot for each pair of variables, this quickly becomes tedious. You can save yourself some work by using a function that produces a matrix of pairwise scatterplots directly. One option for this is to use the <code>pairs</code> function, and supply this with a selection of variables in a data.frame. For instance, in the data set we considered now, we might be interested in the relations between <code>hate_groups_per_million</code>, <code>percent_bachelors_degree_or_higher</code>, <code>percent_in_poverty</code>, and <code>percent_Trump_votes</code>. We can obtain a matrix of all pairwise scatterplots between these variables as follows (note that rather than typing the variable names, I’m selecting column 4 to 7, which correspond to these variables):</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="regression.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dat[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>If you don’t like the look of these base R graphics and prefer <code>ggplot2</code>, you can use the <code>ggpairs</code> function from the <code>GGally</code> <span class="citation">(<a href="#ref-R-GGally" role="doc-biblioref">Schloerke et al. 2021</a>)</span> package to get a similar plot:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="regression.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb168-2"><a href="regression.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(dat[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="multicollinearity-and-outlier-detection" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Multicollinearity and outlier detection</h2>
<p>The <code>car</code> package provides useful functions to assess multicollinearity. In particular, it provides the <code>vif</code> function to compute the Variance Inflation Factor (VIF) for each predictor in the data.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="regression.html#cb169-1" aria-hidden="true" tabindex="-1"></a>modg_vif <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">vif</span>(modg)</span>
<span id="cb169-2"><a href="regression.html#cb169-2" aria-hidden="true" tabindex="-1"></a>modg_vif</span></code></pre></div>
<pre><code>##            hate_groups_per_million percent_bachelors_degree_or_higher 
##                           1.093119                           1.093119</code></pre>
<p>To compute the tolerance, you can simply transform the results from this function, as follows:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="regression.html#cb171-1" aria-hidden="true" tabindex="-1"></a>modg_tolerance <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>modg_vif</span>
<span id="cb171-2"><a href="regression.html#cb171-2" aria-hidden="true" tabindex="-1"></a>modg_tolerance</span></code></pre></div>
<pre><code>##            hate_groups_per_million percent_bachelors_degree_or_higher 
##                          0.9148138                          0.9148138</code></pre>
<p>There are a large number of measures to detect potential outliers. You can get many of these with the <code>influence.measures</code> function, which is provided in the (base R) <code>stats</code> package. Let’s try this with the full data set (including the District of Columbia):</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="regression.html#cb173-1" aria-hidden="true" tabindex="-1"></a>modg <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent_Trump_votes <span class="sc">~</span> hate_groups_per_million <span class="sc">+</span> percent_bachelors_degree_or_higher, <span class="at">data=</span>trump2016)</span>
<span id="cb173-2"><a href="regression.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influence.measures</span>(modg)</span></code></pre></div>
<pre><code>## Influence measures of
##   lm(formula = percent_Trump_votes ~ hate_groups_per_million +      percent_bachelors_degree_or_higher, data = trump2016) :
## 
##      dfb.1_  dfb.h___  dfb.p___    dffit cov.r   cook.d    hat inf
## 1  -0.52688 -0.296032  0.521272 -0.56266 1.159 1.04e-01 0.1676    
## 2   0.00392 -0.061502  0.020901  0.09322 1.087 2.94e-03 0.0349    
## 3  -0.03341  0.004670  0.019253 -0.06573 1.077 1.46e-03 0.0225    
## 4  -0.03771 -0.023320  0.035989 -0.04341 1.148 6.41e-04 0.0734    
## 5   0.06591  0.148803 -0.142949 -0.32192 0.876 3.27e-02 0.0277    
## 6  -0.24979 -0.153330  0.304489  0.36014 1.029 4.26e-02 0.0705    
## 7  -0.11843 -0.105623  0.150998  0.18404 1.122 1.14e-02 0.0753    
## 8  -0.01473 -0.013061 -0.007111 -0.12198 1.038 4.99e-03 0.0201    
## 9   2.52447 -5.302567 -1.681047 -6.87659 4.759 1.38e+01 0.8587   *
## 10 -0.02247  0.000377  0.011937 -0.05068 1.080 8.72e-04 0.0211    
## 11  0.00853 -0.004034  0.000226  0.03959 1.081 5.33e-04 0.0198    
## 12  0.08150  0.367500 -0.215915 -0.52466 0.747 8.21e-02 0.0399   *
## 13  0.08875  0.096324 -0.086731  0.13557 1.106 6.22e-03 0.0559    
## 14  0.03414  0.051211 -0.063462 -0.12988 1.054 5.67e-03 0.0274    
## 15  0.00905  0.003813 -0.007741  0.01140 1.105 4.42e-05 0.0366    
## 16 -0.02482  0.014259  0.013319 -0.04802 1.089 7.84e-04 0.0273    
## 17 -0.02606 -0.087778  0.083161  0.23956 0.943 1.86e-02 0.0239    
## 18  0.09668  0.060449 -0.090373  0.11583 1.114 4.55e-03 0.0571    
## 19 -0.03092 -0.008024  0.026492 -0.03570 1.113 4.34e-04 0.0445    
## 20 -0.00993  0.025266 -0.009797 -0.07984 1.069 2.16e-03 0.0218    
## 21  0.02121  0.012855 -0.026006 -0.03119 1.139 3.31e-04 0.0656    
## 22 -0.05632 -0.040191  0.067534  0.07593 1.194 1.96e-03 0.1105   *
## 23 -0.05253  0.002615  0.031027 -0.10310 1.058 3.58e-03 0.0222    
## 24 -0.04313 -0.051157  0.063607  0.09606 1.095 3.13e-03 0.0408    
## 25 -0.19099 -0.129701  0.186786 -0.22017 1.139 1.63e-02 0.0926    
## 26  0.05673  0.023999 -0.040637  0.10148 1.062 3.47e-03 0.0235    
## 27  0.08441  0.250403 -0.093250  0.30080 1.047 3.00e-02 0.0642    
## 28  0.03238 -0.057781  0.025177  0.24179 0.917 1.88e-02 0.0208    
## 29 -0.31423  0.029236  0.242506 -0.39419 0.882 4.90e-02 0.0399    
## 30 -0.08398 -0.019730  0.109755  0.17291 1.046 1.00e-02 0.0344    
## 31 -0.09407 -0.083653  0.121603  0.15189 1.116 7.80e-03 0.0652    
## 32 -0.19154  0.123269  0.103240 -0.36583 0.836 4.16e-02 0.0292    
## 33  0.05688  0.055368 -0.081363 -0.12081 1.083 4.93e-03 0.0386    
## 34  0.00256 -0.000673 -0.000647  0.00874 1.087 2.60e-05 0.0200    
## 35  0.06753 -0.143108  0.016610  0.32284 0.852 3.27e-02 0.0251    
## 36 -0.02617 -0.003339  0.018595 -0.04122 1.088 5.78e-04 0.0250    
## 37  0.16554 -0.022263 -0.122110  0.22264 1.011 1.64e-02 0.0344    
## 38  0.01776  0.035477 -0.042254 -0.10704 1.060 3.86e-03 0.0242    
## 39 -0.00413  0.001328  0.000514 -0.01652 1.086 9.28e-05 0.0198    
## 40  0.04014  0.090825 -0.075753 -0.14660 1.067 7.23e-03 0.0367    
## 41  0.01379 -0.001198 -0.009068  0.02285 1.091 1.78e-04 0.0249    
## 42  0.16164  0.235335 -0.162909  0.30237 1.030 3.02e-02 0.0581    
## 43  0.11823  0.095192 -0.108844  0.16490 1.072 9.14e-03 0.0433    
## 44  0.00868 -0.006344 -0.002861  0.02384 1.088 1.93e-04 0.0227    
## 45  0.00224  0.007721 -0.005479 -0.01283 1.101 5.61e-05 0.0327    
## 46  0.13369  0.127883 -0.176909 -0.22824 1.075 1.74e-02 0.0595    
## 47 -0.10655 -0.025968  0.131619  0.18477 1.059 1.14e-02 0.0423    
## 48  0.04786  0.044087 -0.072617 -0.12127 1.068 4.96e-03 0.0314    
## 49  0.16158  0.033660 -0.144034  0.17103 1.125 9.88e-03 0.0745    
## 50 -0.02618  0.027968  0.006136 -0.07926 1.074 2.13e-03 0.0240    
## 51  0.27179  0.076981 -0.211548  0.38638 0.801 4.58e-02 0.0280   *</code></pre>
<p>You can see that this provides a quite a few measures for each case (i.e. state) in the data! The first three are so-called <a href="https://en.wikipedia.org/wiki/Influential_observation">DFBETAS</a> measures, which reflect the standardized difference in the estimated parameters (intercept and slopes of <code>hate_groups_per_million</code> and <code>percent_bachelors_degree_or_higher</code>, respectively) that result from deleting that particular case from the data. The <code>dffit</code> column refers to the <a href="https://en.wikipedia.org/wiki/DFFITS">DFFITS</a> measure shows the difference in the standardized predicted value for that case, after removing the case for the estimation of the model. The value in the <code>cov.r</code> column is the covariance ratio measure, which assesses the influence of a case on multicollinearity. Then the Cook’s distance is provided in the <code>cook.d</code> column, and the <code>hat</code> column provides the leverage values. Finally, the <code>inf</code> column flags potential outliers according to any of these measures.</p>
<p>I would not advice you to blindly delete the flagged cases. These are cases which <em>may</em> be outliers. Personally, I use the Cook’s distance more than the other measures. You can obtain just the Cook’s distances with the <code>cooks.distance</code> function:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="regression.html#cb175-1" aria-hidden="true" tabindex="-1"></a>modg_cooks_distance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modg)</span>
<span id="cb175-2"><a href="regression.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get a quick summary of the values</span></span>
<span id="cb175-3"><a href="regression.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modg_cooks_distance)</span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##  0.000026  0.001169  0.004989  0.284643  0.018019 13.810613</code></pre>
<p>The summary shows that there is at least one case with a Cook’s distance larger than 1. We can see which states have a large Cook’s distance as follows:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="regression.html#cb177-1" aria-hidden="true" tabindex="-1"></a>trump2016<span class="sc">$</span>state[<span class="fu">which</span>(modg_cooks_distance <span class="sc">&gt;</span> <span class="dv">1</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;District of Columbia&quot;</code></pre>
<p>which indicates that the District of Columbia is likely an outlier.</p>
<!-- 
## Computing the estimated parameters with matrix algebra

As indicated in the lecture, computing the estimates of the intercept and slopes of a multiple regression model is not as straightforward as it is for a simple (bivariate) regression. But using matrix algebra, 

$$\mathbf{b} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}$$
-->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-car" class="csl-entry">
Fox, John, Sanford Weisberg, and Brad Price. 2021. <em>Car: Companion to Applied Regression</em>. <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>.
</div>
<div id="ref-R-GGally" class="csl-entry">
Schloerke, Barret, Di Cook, Joseph Larmarange, Francois Briatte, Moritz Marbach, Edwin Thoen, Amos Elberg, and Jason Crowley. 2021. <em>GGally: Extension to Ggplot2</em>. <a href="https://CRAN.R-project.org/package=GGally">https://CRAN.R-project.org/package=GGally</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-one-sample-t-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="moderation-and-mediation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"source": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
