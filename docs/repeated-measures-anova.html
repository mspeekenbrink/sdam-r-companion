<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Repeated-measures ANOVA | An R companion to Statistics: data analysis and modelling</title>
  <meta name="description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Repeated-measures ANOVA | An R companion to Statistics: data analysis and modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  <meta name="github-repo" content="mspeekenbrink/sdam-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Repeated-measures ANOVA | An R companion to Statistics: data analysis and modelling" />
  
  <meta name="twitter:description" content="A book about how to use R related to the book Statistics: Data analysis and modelling." />
  

<meta name="author" content="Maarten Speekenbrink" />


<meta name="date" content="2021-11-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="factorial-anova.html"/>
<link rel="next" href="linear-mixed-effects-models.html"/>
<script src="book_assets/header-attrs-2.11/header-attrs.js"></script>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#download-r"><i class="fa fa-check"></i><b>1.2.1</b> Download R</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#download-r-studio"><i class="fa fa-check"></i><b>1.2.2</b> Download R Studio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#working-with-rstudio"><i class="fa fa-check"></i><b>1.3</b> Working with RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing packages</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#installing-the-sdamr-package"><i class="fa fa-check"></i><b>1.4.1</b> Installing the <code>sdamr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.5</b> Getting help</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#first-steps-r-as-a-calculator"><i class="fa fa-check"></i><b>1.6</b> First steps: R as a calculator</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#data"><i class="fa fa-check"></i><b>1.7</b> Data</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#data-types"><i class="fa fa-check"></i><b>1.7.1</b> Data types</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction.html"><a href="introduction.html#objects"><i class="fa fa-check"></i><b>1.7.2</b> Objects</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction.html"><a href="introduction.html#importing-data"><i class="fa fa-check"></i><b>1.7.3</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#exploring-data-descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Exploring data: Descriptive statistics</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#exploring-data-creating-plots"><i class="fa fa-check"></i><b>1.9</b> Exploring data: Creating plots</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introduction.html"><a href="introduction.html#histogram"><i class="fa fa-check"></i><b>1.9.1</b> Histogram</a></li>
<li class="chapter" data-level="1.9.2" data-path="introduction.html"><a href="introduction.html#boxplot"><i class="fa fa-check"></i><b>1.9.2</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#scatterplot"><i class="fa fa-check"></i><b>1.10</b> Scatterplot</a></li>
<li class="chapter" data-level="1.11" data-path="introduction.html"><a href="introduction.html#raincloud-plot"><i class="fa fa-check"></i><b>1.11</b> Raincloud plot</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-modelling.html"><a href="statistical-modelling.html"><i class="fa fa-check"></i><b>2</b> Statistical modelling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#distributions"><i class="fa fa-check"></i><b>2.1</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#generating-random-data"><i class="fa fa-check"></i><b>2.1.1</b> Generating random data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#estimation"><i class="fa fa-check"></i><b>2.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-modelling.html"><a href="statistical-modelling.html#the-likelihood-function"><i class="fa fa-check"></i><b>2.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-modelling.html"><a href="statistical-modelling.html#calculating-the-likelihood-ratio"><i class="fa fa-check"></i><b>2.2.2</b> Calculating the likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-modelling.html"><a href="statistical-modelling.html#hypothesis-testing-directly-with-the-binomial-distribution"><i class="fa fa-check"></i><b>2.3</b> Hypothesis testing directly with the binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html"><i class="fa fa-check"></i><b>3</b> The one-sample t-test</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#missing-values"><i class="fa fa-check"></i><b>3.1</b> Missing values</a></li>
<li class="chapter" data-level="3.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#selecting-subsets-of-data"><i class="fa fa-check"></i><b>3.2</b> Selecting subsets of data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#indexing-variables"><i class="fa fa-check"></i><b>3.2.1</b> Indexing variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#the-subset-function"><i class="fa fa-check"></i><b>3.2.2</b> The <code>subset</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> One-sample t-test</a></li>
<li class="chapter" data-level="3.4" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#effect-size"><i class="fa fa-check"></i><b>3.4</b> Effect size</a></li>
<li class="chapter" data-level="3.5" data-path="the-one-sample-t-test.html"><a href="the-one-sample-t-test.html#nonparametric-bootstrap"><i class="fa fa-check"></i><b>3.5</b> Nonparametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>4</b> Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression.html"><a href="regression.html#estimating-an-testing-a-simple-regression-model"><i class="fa fa-check"></i><b>4.1</b> Estimating an testing a simple regression model</a></li>
<li class="chapter" data-level="4.2" data-path="regression.html"><a href="regression.html#model-comparisons"><i class="fa fa-check"></i><b>4.2</b> Model comparisons</a></li>
<li class="chapter" data-level="4.3" data-path="regression.html"><a href="regression.html#estimating-and-testing-a-multiple-regression-model"><i class="fa fa-check"></i><b>4.3</b> Estimating and testing a multiple regression model</a></li>
<li class="chapter" data-level="4.4" data-path="regression.html"><a href="regression.html#residuals-and-predicted-values"><i class="fa fa-check"></i><b>4.4</b> Residuals and predicted values</a></li>
<li class="chapter" data-level="4.5" data-path="regression.html"><a href="regression.html#plotting-pairwise-scatterplots-for-many-variables"><i class="fa fa-check"></i><b>4.5</b> Plotting pairwise scatterplots for many variables</a></li>
<li class="chapter" data-level="4.6" data-path="regression.html"><a href="regression.html#multicollinearity-and-outlier-detection"><i class="fa fa-check"></i><b>4.6</b> Multicollinearity and outlier detection</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html"><i class="fa fa-check"></i><b>5</b> Moderation and mediation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#moderation-in-linear-models"><i class="fa fa-check"></i><b>5.1</b> Moderation in linear models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#a-bit-about-namespaces"><i class="fa fa-check"></i><b>5.1.1</b> A bit about namespaces</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#centering"><i class="fa fa-check"></i><b>5.2</b> Centering</a></li>
<li class="chapter" data-level="5.3" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#mediation-analysis"><i class="fa fa-check"></i><b>5.3</b> Mediation analysis</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#causal-steps"><i class="fa fa-check"></i><b>5.3.1</b> Causal steps</a></li>
<li class="chapter" data-level="5.3.2" data-path="moderation-and-mediation.html"><a href="moderation-and-mediation.html#investigating-the-moderated-indirect-effect-with-a-bootstrap-test"><i class="fa fa-check"></i><b>5.3.2</b> Investigating the moderated (indirect) effect with a bootstrap test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html"><i class="fa fa-check"></i><b>6</b> Contrast coding and oneway ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#computing-contrast-coding-predictors"><i class="fa fa-check"></i><b>6.1</b> Computing contrast-coding predictors</a></li>
<li class="chapter" data-level="6.2" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#assigning-contrasts-to-factors"><i class="fa fa-check"></i><b>6.2</b> Assigning contrasts to factors</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="contrast-coding-and-oneway-anova.html"><a href="contrast-coding-and-oneway-anova.html#default-coding-schemes"><i class="fa fa-check"></i><b>6.2.1</b> Default coding schemes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="factorial-anova.html"><a href="factorial-anova.html"><i class="fa fa-check"></i><b>7</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="factorial-anova.html"><a href="factorial-anova.html#rainclouds-for-factorial-designs"><i class="fa fa-check"></i><b>7.1</b> Rainclouds for factorial designs</a></li>
<li class="chapter" data-level="7.2" data-path="factorial-anova.html"><a href="factorial-anova.html#formulating-estimating-and-testing-a-factorial-anova"><i class="fa fa-check"></i><b>7.2</b> Formulating, estimating, and testing a factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="factorial-anova.html"><a href="factorial-anova.html#a-threeway-anova"><i class="fa fa-check"></i><b>7.2.1</b> A threeway ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="factorial-anova.html"><a href="factorial-anova.html#type-1-2-and-3-sums-of-squares"><i class="fa fa-check"></i><b>7.3</b> Type 1, 2, and 3 Sums of Squares</a></li>
<li class="chapter" data-level="7.4" data-path="factorial-anova.html"><a href="factorial-anova.html#planned-comparisons-and-post-hoc-tests-with-emmeans"><i class="fa fa-check"></i><b>7.4</b> Planned comparisons and post-hoc tests with <code>emmeans</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="factorial-anova.html"><a href="factorial-anova.html#adjusted-p-values"><i class="fa fa-check"></i><b>7.4.1</b> Adjusted p-values</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="factorial-anova.html"><a href="factorial-anova.html#testing-general-contrasts-with-emmeans"><i class="fa fa-check"></i><b>7.5</b> Testing general contrasts with <code>emmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>8</b> Repeated-measures ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#long-and-wide-data"><i class="fa fa-check"></i><b>8.1</b> Long and wide data</a></li>
<li class="chapter" data-level="8.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-separate-glms"><i class="fa fa-check"></i><b>8.2</b> Repeated-measures ANOVA with separate GLMs</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#computing-within-subjects-composite-scores"><i class="fa fa-check"></i><b>8.2.1</b> Computing within-subjects composite scores</a></li>
<li class="chapter" data-level="8.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#performing-a-repeated-measures-anova-with-separate-models"><i class="fa fa-check"></i><b>8.2.2</b> Performing a repeated-measures ANOVA with separate models</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-car-package"><i class="fa fa-check"></i><b>8.3</b> Repeated-measures ANOVA with the <code>car</code> package</a></li>
<li class="chapter" data-level="8.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-with-the-afex-package"><i class="fa fa-check"></i><b>8.4</b> Repeated-measures ANOVA with the <code>afex</code> package</a></li>
<li class="chapter" data-level="8.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#contrasts-with-the-emmeans-package"><i class="fa fa-check"></i><b>8.5</b> Contrasts with the <code>emmeans</code> package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html"><i class="fa fa-check"></i><b>9</b> Linear mixed-effects models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#formulating-and-estimating-linear-mixed-effects-models-with-lme4"><i class="fa fa-check"></i><b>9.1</b> Formulating and estimating linear mixed-effects models with <code>lme4</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-model"><i class="fa fa-check"></i><b>9.1.1</b> Random intercepts model</a></li>
<li class="chapter" data-level="9.1.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#visually-assessing-model-assumptions"><i class="fa fa-check"></i><b>9.1.2</b> Visually assessing model assumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#random-intercepts-and-slopes"><i class="fa fa-check"></i><b>9.1.3</b> Random intercepts and slopes</a></li>
<li class="chapter" data-level="9.1.4" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#likelihood-ratio-test-with-the-anova-function"><i class="fa fa-check"></i><b>9.1.4</b> Likelihood ratio test with the <code>anova</code> function</a></li>
<li class="chapter" data-level="9.1.5" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.1.6" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#plotting-model-predictions"><i class="fa fa-check"></i><b>9.1.6</b> Plotting model predictions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models.html"><a href="linear-mixed-effects-models.html#obtaining-p-values-with-afexmixed"><i class="fa fa-check"></i><b>9.2</b> Obtaining p-values with <code>afex::mixed</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html"><i class="fa fa-check"></i><b>10</b> Bayesian hypothesis testing through Bayes Factors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#the-bayesfactor-package"><i class="fa fa-check"></i><b>10.1</b> The <code>BayesFactor</code> package</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-one-sample-t-test"><i class="fa fa-check"></i><b>10.1.1</b> A Bayesian one-sample t-test</a></li>
<li class="chapter" data-level="10.1.2" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-two-sample-t-test"><i class="fa fa-check"></i><b>10.1.2</b> A Bayesian two-sample t-test</a></li>
<li class="chapter" data-level="10.1.3" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#a-bayesian-anova"><i class="fa fa-check"></i><b>10.1.3</b> A Bayesian ANOVA</a></li>
<li class="chapter" data-level="10.1.4" data-path="bayesian-hypothesis-testing-through-bayes-factors.html"><a href="bayesian-hypothesis-testing-through-bayes-factors.html#bayesian-regression-and-ancova"><i class="fa fa-check"></i><b>10.1.4</b> Bayesian regression and ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html"><i class="fa fa-check"></i><b>11</b> Reproducible reports with RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#yaml-headers"><i class="fa fa-check"></i><b>11.1</b> YAML headers</a></li>
<li class="chapter" data-level="11.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#markdown-syntax"><i class="fa fa-check"></i><b>11.2</b> Markdown syntax</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#inline-formatting"><i class="fa fa-check"></i><b>11.2.1</b> Inline formatting</a></li>
<li class="chapter" data-level="11.2.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#block-level-elements"><i class="fa fa-check"></i><b>11.2.2</b> Block-level elements</a></li>
<li class="chapter" data-level="11.2.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#math-expressions"><i class="fa fa-check"></i><b>11.2.3</b> Math expressions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#r-code"><i class="fa fa-check"></i><b>11.3</b> R code chunks and inline R code</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#figures"><i class="fa fa-check"></i><b>11.3.1</b> Figures</a></li>
<li class="chapter" data-level="11.3.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#tables"><i class="fa fa-check"></i><b>11.3.2</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#apa-documents-with-papaja"><i class="fa fa-check"></i><b>11.4</b> APA documents with <code>papaja</code></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#installation"><i class="fa fa-check"></i><b>11.4.1</b> Installation</a></li>
<li class="chapter" data-level="11.4.2" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#how-to-use-papaja"><i class="fa fa-check"></i><b>11.4.2</b> How to use papaja</a></li>
<li class="chapter" data-level="11.4.3" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#getting-help-1"><i class="fa fa-check"></i><b>11.4.3</b> Getting help</a></li>
<li class="chapter" data-level="11.4.4" data-path="reproducible-reports-with-rmarkdown.html"><a href="reproducible-reports-with-rmarkdown.html#other-related-r-packages"><i class="fa fa-check"></i><b>11.4.4</b> Other related R packages</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R companion to Statistics: data analysis and modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="repeated-measures-anova" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Repeated-measures ANOVA</h1>
<p>In this Chapter, we will focus on performing repeated-measures ANOVA with R.
We will use the same data analysed in Chapter 10 of SDAM, which is from an
experiment investigating the “cheerleader effect.” The dataset is
available in the <code>sdamr</code> package as <code>cheerleader</code>. We can load it from there,
and inspect the first six cases, as usual:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="repeated-measures-anova.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sdamr)</span>
<span id="cb315-2"><a href="repeated-measures-anova.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cheerleader&quot;</span>)</span>
<span id="cb315-3"><a href="repeated-measures-anova.html#cb315-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cheerleader)</span></code></pre></div>
<pre><code>##   Participant Age    Sex                  Task LineClickAccuracy Excluded WhyExcluded
## 1           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 3           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 4           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 6           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
## 8           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
## 9           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
##                      Item Response
## 1                   Alone 52.71289
## 3           Control_Group 56.15966
## 4 Distractor_Manipulation 53.27871
## 6                   Alone 52.47199
## 8           Control_Group 55.29972
## 9 Distractor_Manipulation 55.17647</code></pre>
<p>This dataset is a little messy, and includes participants who were excluded
by the authors. So let’s first clean it up a little:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="repeated-measures-anova.html#cb317-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> cheerleader</span>
<span id="cb317-2"><a href="repeated-measures-anova.html#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove participants which should be excluded</span></span>
<span id="cb317-3"><a href="repeated-measures-anova.html#cb317-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat, Excluded <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb317-4"><a href="repeated-measures-anova.html#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of unused factor levels in Item by </span></span>
<span id="cb317-5"><a href="repeated-measures-anova.html#cb317-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Item <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Item)</span></code></pre></div>
<p>Another thing is that the labels of the factors don’t correspond to the ones I used in writing the SDAM chapter.
Relabelling factors is somewhat tedious with base R. It’s easier to use the <code>fct_recode</code> function from the <code>forcats</code> package <span class="citation">(<a href="#ref-R-forcats" role="doc-biblioref">Wickham 2021a</a>)</span>.
This function takes a factor as its first argument, and then in the remaining arguments, you
can specify a new label (unquoted) for existing labels (quoted). As usual,
if you don’t have this package installed, you would first need to run <code>install.packages("forcats")</code> before running the code below:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="repeated-measures-anova.html#cb318-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Presentation <span class="ot">&lt;-</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(dat<span class="sc">$</span>Item, <span class="at">Different =</span> <span class="st">&quot;Control_Group&quot;</span>, <span class="at">Similar =</span> <span class="st">&quot;Distractor_Manipulation&quot;</span>)</span>
<span id="cb318-2"><a href="repeated-measures-anova.html#cb318-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Version <span class="ot">&lt;-</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(dat<span class="sc">$</span>Task, <span class="at">Identical =</span> <span class="st">&quot;Identical-Distractors&quot;</span>, <span class="at">Variant =</span> <span class="st">&quot;Self-Distractors&quot;</span>)</span></code></pre></div>
<p>Let’s have a look at the resulting data.frame:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="repeated-measures-anova.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   Participant Age    Sex                  Task LineClickAccuracy Excluded WhyExcluded
## 1           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 3           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 4           1  47   Male Identical-Distractors         0.1361274        0        &lt;NA&gt;
## 6           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
## 8           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
## 9           2  19 Female Identical-Distractors        -0.9752861        0        &lt;NA&gt;
##                      Item Response Presentation   Version
## 1                   Alone 52.71289        Alone Identical
## 3           Control_Group 56.15966    Different Identical
## 4 Distractor_Manipulation 53.27871      Similar Identical
## 6                   Alone 52.47199        Alone Identical
## 8           Control_Group 55.29972    Different Identical
## 9 Distractor_Manipulation 55.17647      Similar Identical</code></pre>
<p>Looks good! You can create a raincloud plot for this data as usual:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="repeated-measures-anova.html#cb321-1" aria-hidden="true" tabindex="-1"></a>sdamr<span class="sc">::</span><span class="fu">plot_raincloud</span>(<span class="at">data=</span>dat, <span class="at">y=</span>Response, <span class="at">groups =</span> Presentation) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>Version)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-188-1.svg" width="100%" style="display: block; margin: auto;" /></p>
<div id="long-and-wide-data" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Long and wide data</h2>
<p>The <code>cheerleader</code> data, and our <code>dat</code> <code>data.frame</code> is in the so-called <strong>long format</strong>.
Data in the long format is structured so that each row contains is a single meaningful observation.
Here, that translates to us having
multiple rows for one participant (e.g. there are three rows for Participant 1).
Data in the <strong>wide format</strong> has one row for each unit of observation (e.g. Participant).
For some analyses, the long format is most suitable, whilst for others the wide
format. It is therefore useful to be able to transform the data from one format
to the other. This used to be a real pain back in the days when I started
using R. Luckily, there are now tools available that make this a lot easier.
Here, we will use the <code>pivot_longer</code> and <code>pivot_wider</code> functions from the <code>tidyr</code> <span class="citation">(<a href="#ref-R-tidyr" role="doc-biblioref">Wickham 2021b</a>)</span>
package. The <code>pivot_wider</code> function is used to transform long-format data to the wide format.
In the <code>id_cols</code> argument, you can list variable which identify a “unit of observation” (e.g. Participant), as well
as other variables which don’t vary within subjects (such as condition). In the <code>names_from</code>
argument, you can specify a variable which identifies the within-subjects levels, which
is used to name the resulting new set of dependent variables. In the <code>values_from</code>
argument, you specify the variable which contains the values of the new set
of dependent variables:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="repeated-measures-anova.html#cb322-1" aria-hidden="true" tabindex="-1"></a>wdat <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(dat, <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&quot;Participant&quot;</span>, <span class="st">&quot;Version&quot;</span>), <span class="at">names_from =</span> Presentation, <span class="at">values_from =</span> Response)</span>
<span id="cb322-2"><a href="repeated-measures-anova.html#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wdat)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   Participant Version   Alone Different Similar
##   &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 1           Identical  52.7      56.2    53.3
## 2 2           Identical  52.5      55.3    55.2
## 3 3           Identical  45.9      47.9    47.7
## 4 4           Identical  43.9      50.3    44.2
## 5 5           Identical  37.5      34.7    37.8
## 6 6           Identical  44.4      47.9    45.1</code></pre>
<p>Note that there are quite a few variables no longer from this new wide-format data.
This is not a problem, as we don’t need them for the present analyses (we could also
have kept these in by including them in the <code>id_cols</code> argument).
Also note that the class of this object is not a <code>data.frame</code>, but a <code>tibble</code>.
A tibble is a “modern re-imagining of the data.frame” (<a href="https://tibble.tidyverse.org/" class="uri">https://tibble.tidyverse.org/</a>).
It is a central part of the <a href="https://https://www.tidyverse.org/">tidyverse</a>
collection of R packages, which includes the <code>tidyr</code> and <code>forcats</code> packages
we have just used, as well as the <code>ggplot2</code> package, and many more. When you become more
familiar with R programming, you will likely adopt more of the functions and
principles of the tidyverse.</p>
<p>You can transform data from the wide format to the long format with the
<code>pivot_longer</code> function. In the <code>cols</code> argument, you need to specify
which columns in the wide format to transform into a single variable
in the long format. In the <code>names_to</code> argument, you can specify the
name of the resulting identifier for each value, and in the <code>values_to</code>
argument, you can specify the name of the variable in the long format
which contains the values:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="repeated-measures-anova.html#cb324-1" aria-hidden="true" tabindex="-1"></a>ldat <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(wdat, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;Alone&quot;</span>, <span class="st">&quot;Different&quot;</span>, <span class="st">&quot;Similar&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;Presentation&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Response&quot;</span>)</span>
<span id="cb324-2"><a href="repeated-measures-anova.html#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ldat)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Participant Version   Presentation Response
##   &lt;fct&gt;       &lt;fct&gt;     &lt;chr&gt;           &lt;dbl&gt;
## 1 1           Identical Alone            52.7
## 2 1           Identical Different        56.2
## 3 1           Identical Similar          53.3
## 4 2           Identical Alone            52.5
## 5 2           Identical Different        55.3
## 6 2           Identical Similar          55.2</code></pre>
</div>
<div id="repeated-measures-anova-with-separate-glms" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Repeated-measures ANOVA with separate GLMs</h2>
<p>In Chapter 10 of SDAM, we focused on performing repeated-measures ANOVA
by constructing within-subjects composite scores, and then performing
separate GLM analyses on these. We will start with this approach,
and analyse the full 2 (Version: Identical, Variant) by 3 (Presentation: Alone,
Different, Similar) design.</p>
<div id="computing-within-subjects-composite-scores" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Computing within-subjects composite scores</h3>
<p>The within-subjects composite scores are effectively
contrasts, computed for each participant. Let’s define the following contrasts:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(d_0\)</span></th>
<th align="right"><span class="math inline">\(d_1\)</span></th>
<th align="right"><span class="math inline">\(d_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alone</td>
<td align="right">1</td>
<td align="right"><span class="math inline">\(-\tfrac{2}{3}\)</span></td>
<td align="right"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td align="left">Different</td>
<td align="right">1</td>
<td align="right"><span class="math inline">\(\tfrac{1}{3}\)</span></td>
<td align="right"><span class="math inline">\(\tfrac{1}{2}\)</span></td>
</tr>
<tr class="odd">
<td align="left">Similar</td>
<td align="right">1</td>
<td align="right"><span class="math inline">\(\tfrac{1}{3}\)</span></td>
<td align="right"><span class="math inline">\(-\tfrac{1}{2}\)</span></td>
</tr>
</tbody>
</table>
<p>We can compute each composite score from these contrasts as:
<span class="math display">\[W_{j,i} = \frac{\sum_{k=1}^g d_{j,k} Y_{i,k}}{\sqrt{\sum_{k=1}^g d_{j,k}^2}}\]</span>
For <span class="math inline">\(W_0\)</span> (i.e. <span class="math inline">\(j=0\)</span>), the computation in R is:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="repeated-measures-anova.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the top part (numerator)</span></span>
<span id="cb326-2"><a href="repeated-measures-anova.html#cb326-2" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>W0 <span class="ot">&lt;-</span> wdat<span class="sc">$</span>Alone <span class="sc">+</span> wdat<span class="sc">$</span>Different <span class="sc">+</span> wdat<span class="sc">$</span>Similar</span>
<span id="cb326-3"><a href="repeated-measures-anova.html#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply scaling factor to get the correct SS</span></span>
<span id="cb326-4"><a href="repeated-measures-anova.html#cb326-4" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>W0 <span class="ot">&lt;-</span> wdat<span class="sc">$</span>W0<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>)</span></code></pre></div>
<p>Similarly, we can compute <span class="math inline">\(W_1\)</span> and <span class="math inline">\(W_2\)</span> as:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="repeated-measures-anova.html#cb327-1" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>W1 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>wdat<span class="sc">$</span>Different <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>wdat<span class="sc">$</span>Similar <span class="sc">-</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>wdat<span class="sc">$</span>Alone</span>
<span id="cb327-2"><a href="repeated-measures-anova.html#cb327-2" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>W1 <span class="ot">&lt;-</span> wdat<span class="sc">$</span>W1<span class="sc">/</span><span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb327-3"><a href="repeated-measures-anova.html#cb327-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-4"><a href="repeated-measures-anova.html#cb327-4" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>W2 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>wdat<span class="sc">$</span>Different <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>wdat<span class="sc">$</span>Similar</span>
<span id="cb327-5"><a href="repeated-measures-anova.html#cb327-5" aria-hidden="true" tabindex="-1"></a>wdat<span class="sc">$</span>w2 <span class="ot">&lt;-</span> wdat<span class="sc">$</span>W2<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="performing-a-repeated-measures-anova-with-separate-models" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Performing a repeated-measures ANOVA with separate models</h3>
<p>We now have three new dependent variables (<span class="math inline">\(W_0\)</span>, <span class="math inline">\(W_1\)</span>, and <span class="math inline">\(W_2\)</span>), and for each
we can perform a GLM analysis. To do this, we need to set a suitable contrast for Version.
As in SDAM, I will use <span class="math inline">\((\tfrac{1}{2}, -\tfrac{1}{2})\)</span> for the Identical and Variant
conditions respectively:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="repeated-measures-anova.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(wdat<span class="sc">$</span>Version) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span></code></pre></div>
<p>We can then estimate a linear model for each composite variable. For <span class="math inline">\(W_0\)</span>,
we estimate:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="repeated-measures-anova.html#cb329-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(W0 <span class="sc">~</span> Version, <span class="at">data=</span>wdat)</span>
<span id="cb329-2"><a href="repeated-measures-anova.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = W0 ~ Version, data = wdat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -59.928  -4.593   1.922   9.059  31.259 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  82.5764     2.1153  39.038   &lt;2e-16 ***
## Version1      0.8647     4.2305   0.204    0.839    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.23 on 57 degrees of freedom
## Multiple R-squared:  0.0007323,  Adjusted R-squared:  -0.0168 
## F-statistic: 0.04177 on 1 and 57 DF,  p-value: 0.8388</code></pre>
<p>Note that the estimated parameters are in the scale of <span class="math inline">\(W_0\)</span>, not in the scale
of the dependent variable (<span class="math inline">\(Y\)</span>). We can get the rescaled estimates by dividing
the estimates by the scaling factor (<span class="math inline">\(\sqrt{3}\)</span> in this case). The <code>coefficients</code>
functions extracts the parameter estimates from the model. Hence, the rescaled
estimates can be computed as:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="repeated-measures-anova.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod0)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## (Intercept)    Version1 
##   47.675478    0.499217</code></pre>
<p>To obtain equivalent <span class="math inline">\(F\)</span>-tests, we can use the <code>Anova</code> function from the <code>car</code> package:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="repeated-measures-anova.html#cb333-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod0, <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: W0
##             Sum Sq Df   F value Pr(&gt;F)    
## (Intercept) 401272  1 1523.9890 &lt;2e-16 ***
## Version         11  1    0.0418 0.8388    
## Residuals    15008 57                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The procedure for the within-subjects composite scores <span class="math inline">\(W_1\)</span> and <span class="math inline">\(W_2\)</span> is
similar. For <span class="math inline">\(W_1\)</span>, the analysis is:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="repeated-measures-anova.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis for W1</span></span>
<span id="cb335-2"><a href="repeated-measures-anova.html#cb335-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(W1 <span class="sc">~</span> Version, <span class="at">data=</span>wdat)</span>
<span id="cb335-3"><a href="repeated-measures-anova.html#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = W1 ~ Version, data = wdat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8388 -1.0661 -0.0307  0.9773  3.6227 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.057739   0.190904   5.541 8.02e-07 ***
## Version1    -0.008033   0.381808  -0.021    0.983    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.464 on 57 degrees of freedom
## Multiple R-squared:  7.766e-06,  Adjusted R-squared:  -0.01754 
## F-statistic: 0.0004426 on 1 and 57 DF,  p-value: 0.9833</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="repeated-measures-anova.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">9</span>)</span></code></pre></div>
<pre><code>## (Intercept)    Version1 
##  1.29546036 -0.00983829</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="repeated-measures-anova.html#cb339-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: W1
##              Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)  65.839  1 30.6992 8.023e-07 ***
## Version       0.001  1  0.0004    0.9833    
## Residuals   122.245 57                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>And for <span class="math inline">\(W_2\)</span>, it is:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="repeated-measures-anova.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis for W2</span></span>
<span id="cb341-2"><a href="repeated-measures-anova.html#cb341-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(W2 <span class="sc">~</span> Version, <span class="at">data=</span>wdat)</span>
<span id="cb341-3"><a href="repeated-measures-anova.html#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = W2 ~ Version, data = wdat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.02844 -0.47968 -0.06555  0.36866  2.52549 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.1981     0.1184   1.673   0.0998 .
## Version1      0.5865     0.2368   2.476   0.0163 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9083 on 57 degrees of freedom
## Multiple R-squared:  0.09714,    Adjusted R-squared:  0.0813 
## F-statistic: 6.133 on 1 and 57 DF,  p-value: 0.01626</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="repeated-measures-anova.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mod2)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## (Intercept)    Version1 
##   0.2801500   0.8293672</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="repeated-measures-anova.html#cb345-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod2, <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: W2
##             Sum Sq Df F value  Pr(&gt;F)  
## (Intercept)  2.309  1  2.7991 0.09980 .
## Version      5.060  1  6.1330 0.01626 *
## Residuals   47.026 57                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Unfortunately, there is no simple way to obtain omnibus tests by combining
these models. They can be computed “manually,” by extracting the relevant
SSR, SSE, and df terms from the models. These can then be used to compute an
<span class="math inline">\(F\)</span>-statistic, and the <span class="math inline">\(p\)</span>-value can then be computed by using the <code>pf</code> function.</p>
<p>This is not the most straightforward manner to obtain omnibus tests
(the following sections show how to do this in a much more convenient manner).
But to show it is doable, let’s compute the omnibus test for the main effect of
Presentation in this way. The relevant SSR, SSE, and df terms are stored
in the objects returned by the <code>car::Anova</code> function. We can see the structure
of this object with the <code>str</code> function:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="repeated-measures-anova.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Classes &#39;anova&#39; and &#39;data.frame&#39;:    3 obs. of  4 variables:
##  $ Sum Sq : num  6.58e+01 9.49e-04 1.22e+02
##  $ Df     : num  1 1 57
##  $ F value: num  3.07e+01 4.43e-04 NA
##  $ Pr(&gt;F) : num  8.02e-07 9.83e-01 NA
##  - attr(*, &quot;heading&quot;)= chr [1:2] &quot;Anova Table (Type III tests)\n&quot; &quot;Response: W1&quot;</code></pre>
<p>This shows that the <code>car::Anova</code> function returns a data.frame with the test
results. The first row corresponds to the test of the intercept (which reflects
the main effects of Presentation in this repeated-measures ANOVA). The last
row contains the values for the error term. The structure for the <code>mod2</code> analysis
is the same. To get the relevant omnibus values, we can just take the appropriate
elements from these data.frames. To get the omnibus SSR and <span class="math inline">\(\text{df}_1\)</span>
terms, we can use:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="repeated-measures-anova.html#cb349-1" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">1</span>] <span class="sc">+</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod2, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">1</span>]</span>
<span id="cb349-2"><a href="repeated-measures-anova.html#cb349-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Df&quot;</span>[<span class="dv">1</span>] <span class="sc">+</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod2, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Df&quot;</span>[<span class="dv">1</span>]</span></code></pre></div>
<p>And for the SSE and <span class="math inline">\(\text{df}_2\)</span> terms, we can use:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="repeated-measures-anova.html#cb350-1" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">3</span>] <span class="sc">+</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod2, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Sum Sq&quot;</span>[<span class="dv">3</span>]</span>
<span id="cb350-2"><a href="repeated-measures-anova.html#cb350-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod1, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Df&quot;</span>[<span class="dv">3</span>] <span class="sc">+</span> car<span class="sc">::</span><span class="fu">Anova</span>(mod2, <span class="at">type=</span><span class="dv">3</span>)<span class="sc">$</span><span class="st">&quot;Df&quot;</span>[<span class="dv">3</span>]</span></code></pre></div>
<p>With these values, the <span class="math inline">\(F\)</span>-statistic can then be computed as follows:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="repeated-measures-anova.html#cb351-1" aria-hidden="true" tabindex="-1"></a>Fstat <span class="ot">&lt;-</span> (SSR<span class="sc">/</span>df1)<span class="sc">/</span>(SSE<span class="sc">/</span>df2)</span></code></pre></div>
<p>Finally, the <span class="math inline">\(p\)</span>-value can be obtained as</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="repeated-measures-anova.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(Fstat, <span class="at">df1=</span>df1, <span class="at">df2=</span>df2)</span></code></pre></div>
<pre><code>## [1] 4.214718e-09</code></pre>
<p>Note that we need to use <code>1-pf</code> as the <code>pf</code> function computes the probability
<span class="math inline">\(P(F \leq \text{value})\)</span>, whilst we need <span class="math inline">\(P(F &gt; \text{value})\)</span>, and this equals
<span class="math inline">\(P(F &gt; \text{value}) = 1 - P(F \leq \text{value})\)</span>.</p>
<p>The steps we have just taken is a perfectly valid manner to conduct a
repeated-measures ANOVA, but it is a laborious process. An easier way
to conduct repeated-measures ANOVA is provided in the <code>car</code> or
<code>afex</code> package. Neither of these packages provide the tests for the individual
contrasts we have just obtained. But these can be computed with the <code>emmeans</code>
package, after conducting the omnibus tests.</p>
</div>
</div>
<div id="repeated-measures-anova-with-the-car-package" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Repeated-measures ANOVA with the <code>car</code> package</h2>
<p>When you have data in the wide format, you can obtain a repeated-measures ANOVA
by using the <code>Anova</code> function from the <code>car</code> package <span class="citation">(<a href="#ref-R-car" role="doc-biblioref">Fox, Weisberg, and Price 2021</a>)</span>. As you will see later,
the analysis is more straightforward with the <code>afex</code> package, but this requires
data to be in the long format.</p>
<p>The first step to performing a repeated-measures ANOVA with the <code>car</code> package
is to perform a linear model for a multivariate dependent variable, which basically
means providing a matrix of each repeated measurement as the DV. This is done
by collating the variables within a <code>cbind</code> (for column-bind) argument within
the model formula:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="repeated-measures-anova.html#cb354-1" aria-hidden="true" tabindex="-1"></a>mvmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(Alone, Different, Similar) <span class="sc">~</span> Version, <span class="at">data=</span>wdat)</span></code></pre></div>
<p>So here, we are modelling the Alone, Different, and Similar attractiveness
ratings simultaneously as a function of the Version categorical predictor.
This model is basically a set of three linear regressions, as you can see from
the output:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="repeated-measures-anova.html#cb355-1" aria-hidden="true" tabindex="-1"></a>mvmod</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = cbind(Alone, Different, Similar) ~ Version, data = wdat)
## 
## Coefficients:
##              Alone     Different  Similar 
## (Intercept)  46.81184  48.30539   47.90920
## Version1      0.50578   1.08239   -0.09051</code></pre>
<p>The next step is to construct an object which reflects the structure of these
three measurements. This has to be done with a separate <code>data.frame</code>, with one
row for each variable included in the <code>cbind</code> function specifying the multivariate DV.
In this case, there is a single categorical predictor underlying all three
measurements. So our <code>data.frame</code> can contain a single factor:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="repeated-measures-anova.html#cb357-1" aria-hidden="true" tabindex="-1"></a>idata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Presentation =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Alone&quot;</span>, <span class="st">&quot;Different&quot;</span>, <span class="st">&quot;Similar&quot;</span>)))</span>
<span id="cb357-2"><a href="repeated-measures-anova.html#cb357-2" aria-hidden="true" tabindex="-1"></a>idata</span></code></pre></div>
<pre><code>##   Presentation
## 1        Alone
## 2    Different
## 3      Similar</code></pre>
<p>The next step is to supply a useful contrast for this within-subjects factor:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="repeated-measures-anova.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(idata<span class="sc">$</span>Presentation) <span class="co"># check the levels</span></span></code></pre></div>
<pre><code>##           Different Similar
## Alone             0       0
## Different         1       0
## Similar           0       1</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="repeated-measures-anova.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(idata<span class="sc">$</span>Presentation) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb361-2"><a href="repeated-measures-anova.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(idata<span class="sc">$</span>Presentation)</span></code></pre></div>
<pre><code>##                 [,1] [,2]
## Alone     -0.6666667  0.0
## Different  0.3333333  0.5
## Similar    0.3333333 -0.5</code></pre>
<p>With these elements in place, we are finally ready to perform the
repeated-measures ANOVA. This involves calling the <code>car::Anova</code> function
with the multivariate linear model as the first argument, and supplying the
within-subjects structure through the <code>idata</code> argument. Additionally, you need to
supply a right-hand-sided formula in the
<code>idesign</code> argument in order to specify which effects to include as within-subjects factors.
The <code>type=3</code> argument, as usual, specifies we would like to perform Type-3 SS tests.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="repeated-measures-anova.html#cb363-1" aria-hidden="true" tabindex="-1"></a>rmaov <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Anova</span>(mvmod, <span class="at">idata=</span>idata, <span class="at">idesign =</span> <span class="sc">~</span>Presentation,  <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb363-2"><a href="repeated-measures-anova.html#cb363-2" aria-hidden="true" tabindex="-1"></a>rmaov</span></code></pre></div>
<pre><code>## 
## Type III Repeated Measures MANOVA Tests: Pillai test statistic
##                      Df test stat approx F num Df den Df    Pr(&gt;F)    
## (Intercept)           1   0.96395  1523.99      1     57 &lt; 2.2e-16 ***
## Version               1   0.00073     0.04      1     57   0.83878    
## Presentation          1   0.36601    16.17      2     56 2.872e-06 ***
## Version:Presentation  1   0.09730     3.02      2     56   0.05691 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>By default, because we have used a multivariate DV, this will show a so-called
MANOVA (Multivariate ANalysis of VAriance). To obtain an ANOVA, we need to set
the <code>multivariate</code> argument in the <code>summary</code> function to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="repeated-measures-anova.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rmaov, <span class="at">multivariate=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
## 
##                      Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)    
## (Intercept)          401272      1  15008.3     57 1523.9890 &lt; 2.2e-16 ***
## Version                  11      1  15008.3     57    0.0418   0.83878    
## Presentation             70      2    216.3    114   18.5675 1.047e-07 ***
## Version:Presentation     10      2    216.3    114    2.6670   0.07379 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Mauchly Tests for Sphericity
## 
##                      Test statistic p-value
## Presentation                0.98188 0.59925
## Version:Presentation        0.98188 0.59925
## 
## 
## Greenhouse-Geisser and Huynh-Feldt Corrections
##  for Departure from Sphericity
## 
##                      GG eps Pr(&gt;F[GG])    
## Presentation         0.9822  1.314e-07 ***
## Version:Presentation 0.9822    0.07485 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                        HF eps   Pr(&gt;F[HF])
## Presentation         1.016935 1.046537e-07
## Version:Presentation 1.016935 7.379140e-02</code></pre>
<p>In addition to an ANOVA table which contains the omnibus tests for the within-
and between-subjects effects, the output provides the Mauchly sphericity test,
and subsequently the Greenhouse-Geisser and Huynh-Feldt corrected tests. The
tables corresponding to these latter two corrected tests report the
Greenhouse-Geisser and Huynh-Feldt estimates (as <code>GG eps</code> and <code>HF eps</code> respectively)
of what I have denoted as
<span class="math inline">\(\hat{\zeta}\)</span>, but is more commonly denoted as <span class="math inline">\(\hat{\epsilon}\)</span>, and the <span class="math inline">\(p\)</span>-value
which results from applying the correction to the degrees of freedom reported
in the <code>Univariate Type III Repeated-Measures ANOVA Assuming Sphericity</code> table.</p>
<p>A notable absence is the tests of the specific contrasts. We can obtain these
by performing analyses on the within-subjects composite scores, as we did
in the previous section.</p>
</div>
<div id="repeated-measures-anova-with-the-afex-package" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Repeated-measures ANOVA with the <code>afex</code> package</h2>
<p>The <code>afex</code> package <span class="citation">(<a href="#ref-R-afex" role="doc-biblioref">Singmann et al. 2021</a>)</span> provides a convenient interface to the <code>car::Anova()</code> function, via its <code>afex::aov_car()</code> function. To use this function, the data needs to be in the long format. You can specify the model with the usual formula interface, and you don’t need to worry about a multivariate response and such things. There is one new thing, however: To specify a repeated-measures ANOVA, the formula needs to contain a special <code>Error()</code> argument. Within the Error argument, you first state the variable which identifies the “units of observations” (i.e. <code>Participant</code> in this case). Then, after a forward-slash (“/”), you list the repeated-measures factor(s). So, the way to perform the repeated-measures ANOVA with the <code>afex</code> package, and the long data (<code>ldat</code>) we created earlier, is:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="repeated-measures-anova.html#cb367-1" aria-hidden="true" tabindex="-1"></a>afmod <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_car</span>(Response <span class="sc">~</span> Version<span class="sc">*</span>Presentation <span class="sc">+</span> <span class="fu">Error</span>(Participant<span class="sc">/</span>Presentation), <span class="at">data=</span>ldat)</span></code></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: Version</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="repeated-measures-anova.html#cb369-1" aria-hidden="true" tabindex="-1"></a>afmod</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: Response
##                 Effect           df    MSE         F   ges p.value
## 1              Version        1, 57 263.30      0.04 &lt;.001    .839
## 2         Presentation 1.96, 111.97   1.93 18.57 ***  .005   &lt;.001
## 3 Version:Presentation 1.96, 111.97   1.93    2.67 + &lt;.001    .075
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1
## 
## Sphericity correction method: GG</code></pre>
<p><code>afex</code> provides an abridged ANOVA table, where the Greenhouse-Geisser correction is automatically applied</p>
<p>Note that <code>afex</code> automatically sets contrasts to <code>contr.sum</code>. That is useful here, as we haven’t set the contrast for <code>Version</code> in the <code>ldat</code> data.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="repeated-measures-anova.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(ldat<span class="sc">$</span>Version) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb371-2"><a href="repeated-measures-anova.html#cb371-2" aria-hidden="true" tabindex="-1"></a>ldat<span class="sc">$</span>Presentation <span class="ot">&lt;-</span> <span class="fu">factor</span>(ldat<span class="sc">$</span>Presentation)</span>
<span id="cb371-3"><a href="repeated-measures-anova.html#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(ldat<span class="sc">$</span>Presentation) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="repeated-measures-anova.html#cb372-1" aria-hidden="true" tabindex="-1"></a>afmod <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_car</span>(Response <span class="sc">~</span> Version<span class="sc">*</span>Presentation <span class="sc">+</span> <span class="fu">Error</span>(Participant<span class="sc">/</span>Presentation), <span class="at">data=</span>ldat, <span class="at">check_contrasts =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: Calculating Type 3 sums with contrasts != &#39;contr.sum&#39; for: Version
##   Results likely bogus or not interpretable!
## You probably want check_contrasts = TRUE or options(contrasts=c(&#39;contr.sum&#39;,&#39;contr.poly&#39;))</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="repeated-measures-anova.html#cb374-1" aria-hidden="true" tabindex="-1"></a>afmod</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: Response
##                 Effect           df    MSE         F   ges p.value
## 1              Version        1, 57 263.30      0.04 &lt;.001    .839
## 2         Presentation 1.96, 111.97   1.93 11.76 ***  .003   &lt;.001
## 3 Version:Presentation 1.96, 111.97   1.93    2.67 + &lt;.001    .075
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1
## 
## Sphericity correction method: GG</code></pre>
<p>Note that we now get a warning…which we will ignore, as our contrasts are fine and we get exactly the same results.</p>
<p>Note that, as neither <code>afex</code>, nor the <code>car::Anova</code> package on which it relies, provides
parameter estimates for the GLM, it doesn’t really matter whether you supply
your own (sum-to-zero) contrasts, or whether you let <code>afex</code> pick a <code>contr.sum()</code> contrast
for you.</p>
<p>The <code>afex</code> package provides a convenient wrapper around the <code>car::Anova()</code> function, and saves you a lot
of work if you have data in the long format. I would generally recommend storing data in the long format,
as this also makes it easier to apply linear mixed-effects models. You can obtain the
results as reported by the <code>car::Anova()</code> function by calling the <code>summary</code> function:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="repeated-measures-anova.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(afmod)</span></code></pre></div>
<pre><code>## 
## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
## 
##                      Sum Sq num Df Error SS den Df  F value    Pr(&gt;F)    
## (Intercept)          192932      1  15008.3     57 732.7366 &lt; 2.2e-16 ***
## Version                  11      1  15008.3     57   0.0418   0.83878    
## Presentation             45      2    216.3    114  11.7553 2.283e-05 ***
## Version:Presentation     10      2    216.3    114   2.6670   0.07379 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Mauchly Tests for Sphericity
## 
##                      Test statistic p-value
## Presentation                0.98188 0.59925
## Version:Presentation        0.98188 0.59925
## 
## 
## Greenhouse-Geisser and Huynh-Feldt Corrections
##  for Departure from Sphericity
## 
##                      GG eps Pr(&gt;F[GG])    
## Presentation         0.9822   2.62e-05 ***
## Version:Presentation 0.9822    0.07485 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                        HF eps   Pr(&gt;F[HF])
## Presentation         1.016935 2.282549e-05
## Version:Presentation 1.016935 7.379140e-02</code></pre>
<p>The <code>afex</code> package also has a function, called <code>nice</code>, to display the abbreviated ANOVA table
we saw earlier. The arguments of this function allow you to change various aspects of the
displayed results. For instance, by default, the “generalized eta-square” is used
as a measure of effect size. You can change this to the partial eta-square by setting
<code>es="pes"</code>. You can also change the correction to the degrees of freedom, from the default <code>correction = "GG"</code> (Greenhouse-Geisser), by setting
<code>correction = "HF"</code> (Huynh-Feldt) or <code>correction = "none"</code> (no correction).
So, for example, we might use</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="repeated-measures-anova.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nice</span>(afmod, <span class="at">es=</span><span class="st">&quot;pes&quot;</span>, <span class="at">correction =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: Response
##                 Effect     df    MSE         F   pes p.value
## 1              Version  1, 57 263.30      0.04 &lt;.001    .839
## 2         Presentation 2, 114   1.90 11.76 ***  .171   &lt;.001
## 3 Version:Presentation 2, 114   1.90    2.67 +  .045    .074
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="contrasts-with-the-emmeans-package" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Contrasts with the <code>emmeans</code> package</h2>
<p>To obtain the individual contrast estimates and tests for a repeated-measures
ANOVA, perhaps the most straightforward procedure is via the <code>emmeans</code> package
<span class="citation">(<a href="#ref-R-emmeans" role="doc-biblioref">Lenth 2021</a>)</span>. We have already discussed the use of this package in
Section 7.4. The <code>emmeans::emmeans()</code> function calculates estimated marginal
means, and it can do so for objects that are returned by the <code>afex::aov_car()</code>
function. For example, we can obtain the marginal means for the different
levels of <code>Version</code> as:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="repeated-measures-anova.html#cb380-1" aria-hidden="true" tabindex="-1"></a>em_version <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(afmod, <span class="at">specs =</span> <span class="sc">~</span> Version)</span></code></pre></div>
<p>The <code>specs</code> argument should contain a right-sided formula with the factor(s) for
which you want to compute the marginal means. You can see that the <code>emmeans</code>
function computes the estimated marginal means, their standard error, associated
degrees of freedom, and confidence intervals:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="repeated-measures-anova.html#cb381-1" aria-hidden="true" tabindex="-1"></a>em_version</span></code></pre></div>
<pre><code>##  Version   emmean   SE df lower.CL upper.CL
##  Identical   47.9 1.77 57     44.4     51.5
##  Variant     47.4 1.68 57     44.1     50.8
## 
## Results are averaged over the levels of: Presentation 
## Confidence level used: 0.95</code></pre>
<p>Contrasts are really just differences between (sets of) marginal means,
or even more generally, linear functions of marginal means. By applying a contrast
code to the marginal means, we obtain a new value (e.g. a difference between
marginal means), which also comes with a standard error and associated degrees of
freedom. These can be used in a one-sample <span class="math inline">\(t\)</span>-test, to test whether this
new values is equal to an assumed value (e.g. 0). For example, we may want to
test whether the difference between the marginal mean of the Identical condition
and the Variant condition is equal to 0, i.e. <span class="math inline">\(H_0: \mu_I - \mu_V = 0\)</span>. The
contrast to transform the means into this difference is <span class="math inline">\((1,-1)\)</span>, because the
sum of the means multiplied by these values is
<span class="math inline">\(1 \times \mu_I + (-1) \times \mu_V = \mu_I - \mu_V\)</span>. Note that these contrasts
work slightly differently than when using contrast-coded predictors in the GLM.
There, we would have used the values <span class="math inline">\((\tfrac{1}{2}, -\tfrac{1}{2})\)</span> to obtain
the same contrast. That is because the slopes of orthogonal contrast-coded
predictors are
<span class="math display">\[\beta_j = \frac{\sum_{k=1}^g c_{j,k} \times \mu_k}{\sum_{k=1}^g c^2_{j,k}}\]</span>
and we would aim for this slope to represent <span class="math inline">\(\mu_I - \mu_V\)</span>. Using <span class="math inline">\((\tfrac{1}{2}, -\tfrac{1}{2})\)</span>,
the slope would be exactly this:
<span class="math display">\[\frac{ \tfrac{1}{2} \mu_I - \tfrac{1}{2} \mu_V}{(\tfrac{1}{2})^2 + (-\tfrac{1}{2})^2} = \frac{ \tfrac{1}{2} \mu_I - \tfrac{1}{2} \mu_V}{\tfrac{1}{2}} = \mu_I - \mu_V\]</span>
As the contrasts in the <code>emmeans</code> package apply directly to the means, we don’t have to worry
about the <span class="math inline">\(\sum_{k=1}^g c^2_{j,k}\)</span> term which scales the slopes of contrast-coded predictors
in the GLM. That is why, when using the <code>emmeans</code> package, we can use <span class="math inline">\((1,-1)\)</span> as our contrast,
instead of <span class="math inline">\((\tfrac{1}{2}, -\tfrac{1}{2})\)</span>.</p>
<p>The <code>emmeans::contrast()</code> function allows us to compute such contrasts of marginal
means, and the corresponding one-sample <span class="math inline">\(t\)</span>-test (against the null-hypothesis that
the resulting value is equal to 0). In the <code>methmod</code> argument, we here supply a named list. The name is not necessary,
but is helpful in identifying the contrasts when you test multiple. The key thing is that we supplied a contrast
with <code>c(1,-1)</code>. The output provides the estimate of the difference between <span class="math inline">\(\mu_I\)</span> and <span class="math inline">\(\mu_V\)</span>,
as well as a <span class="math inline">\(t\)</span>-test and <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="repeated-measures-anova.html#cb383-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">contrast</span>(em_version, <span class="at">method=</span><span class="fu">list</span>(<span class="st">&quot;I - V&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##  contrast estimate   SE df t.ratio p.value
##  I - V       0.499 2.44 57   0.204  0.8388
## 
## Results are averaged over the levels of: Presentation</code></pre>
<p>We can see that this test is not significant, and hence we can’t reject the null-hypothesis that
the true difference between the means is equal to 0. The results are identical to the
test of the slope of <code>Version1</code> for the model of <code>W0</code> in Section 8.2.</p>
<p>We can follow the same procedure to tests contrasts for the Presentation factor. In this case,
the list of contrasts specified in the <code>method</code> argument has two elements. In the first contrast,
we want to determine the difference
<span class="math display">\[\frac{\mu_D + \mu_S}{2} - \mu_A\]</span>
which we can do through the contrast <code>c(-1,.5,.5)</code> (applied to the A, D, and S conditions respectively). In the second
contrast, we want to determine the difference
<span class="math display">\[\mu_D - \mu_S\]</span>
which we can do through the contrast <code>c(0,1,-1)</code>. The following code computes the
marginal means and then performs the contrast-tests on these:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="repeated-measures-anova.html#cb385-1" aria-hidden="true" tabindex="-1"></a>em_presentation <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(afmod, <span class="at">specs =</span> <span class="sc">~</span> Presentation)</span>
<span id="cb385-2"><a href="repeated-measures-anova.html#cb385-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">contrast</span>(em_presentation, <span class="at">method=</span><span class="fu">list</span>(<span class="st">&quot;(D + S)/2 - A&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="st">&quot;D - S&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##  contrast      estimate    SE df t.ratio p.value
##  (D + S)/2 - A    1.295 0.234 57   5.541  &lt;.0001
##  D - S            0.396 0.237 57   1.673  0.0998
## 
## Results are averaged over the levels of: Version</code></pre>
<p>This replicates the earlier results we obtained in Section 8.2 from the tests of the intercepts of <code>W1</code> and <code>W2</code>.</p>
<p>Finally, we can also consider the marginal means of the combinations of the Presentation and Version factors. We
do this by specifying the full (main effects and interaction) model in the <code>specs</code> argument:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="repeated-measures-anova.html#cb387-1" aria-hidden="true" tabindex="-1"></a>em_pv <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(afmod, <span class="at">specs =</span> <span class="sc">~</span> Presentation<span class="sc">*</span>Version)</span></code></pre></div>
<p>The marginal means are</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="repeated-measures-anova.html#cb388-1" aria-hidden="true" tabindex="-1"></a>em_pv</span></code></pre></div>
<pre><code>##  Presentation Version   emmean   SE df lower.CL upper.CL
##  Alone        Identical   47.1 1.78 57     43.5     50.6
##  Different    Identical   48.8 1.78 57     45.3     52.4
##  Similar      Identical   47.9 1.80 57     44.3     51.5
##  Alone        Variant     46.6 1.69 57     43.2     49.9
##  Different    Variant     47.8 1.69 57     44.4     51.1
##  Similar      Variant     48.0 1.71 57     44.5     51.4
## 
## Confidence level used: 0.95</code></pre>
<p>An interaction implies that a contrast for one experimental factor is moderated by the levels of another experimental factor. For example, the difference between
<span class="math display">\[\frac{\mu_D + \mu_S}{2} - \mu_A\]</span>
might be different in the Identical compared to the Variant condition. If that is the case, then the difference between these differences would not equal 0. Such a “difference of differences” is most clearly stated in an equation:
<span class="math display">\[\left(\frac{\mu_{I,D} + \mu_{I,S}}{2} - \mu_{I,A}\right) - \left(\frac{\mu_{V,D} + \mu_{V,S}}{2} - \mu_{V,A}\right)\]</span>
If we were to write this as a sum of all six means, we would do so as follows:
<span class="math display">\[\tfrac{1}{2} \times \mu_{I,D} + \tfrac{1}{2} \mu_{I,S} + (-1) \times \mu_{I,A} + (-\tfrac{1}{2}) \times \mu_{V,D}  + (-\tfrac{1}{2}) \times \mu_{V,S} + 1 \times \mu_{V,A}\]</span>
Hence, the implied contrast code is <code>c(.5, .5, -1, -.5, -.5, 1)</code>. Following a similar logic, the implied contrast
code for the second interaction is <code>c(0, 1, -1, 0, -1, 1)</code>. Supplying these contrast codes to the <code>emmeans::contrast</code> function, we obtain the following results:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="repeated-measures-anova.html#cb390-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">contrast</span>(em_pv, <span class="at">method=</span><span class="fu">list</span>(<span class="st">&quot;c1 by d1&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>), <span class="st">&quot;c1 by d2&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##  contrast estimate    SE df t.ratio p.value
##  c1 by d1 -0.00984 0.468 57  -0.021  0.9833
##  c1 by d2  1.17290 0.474 57   2.476  0.0163</code></pre>
<p>This replicates the results of the estimates and tests of the slopes of <code>Version1</code> in the models of <code>W1</code> and <code>W2</code> of Section 8.2 exactly.</p>
<p>So it doesn’t really matter all that much what form of contrast coding you use in the original analysis (as long as you use a form of sum-to-zero contrast coding). You can always perform the contrast tests afterwards by using the <code>emmeans</code> package (and other packages which provide similar functionality).</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-car" class="csl-entry">
Fox, John, Sanford Weisberg, and Brad Price. 2021. <em>Car: Companion to Applied Regression</em>. <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>.
</div>
<div id="ref-R-emmeans" class="csl-entry">
Lenth, Russell V. 2021. <em>Emmeans: Estimated Marginal Means, Aka Least-Squares Means</em>. <a href="https://github.com/rvlenth/emmeans">https://github.com/rvlenth/emmeans</a>.
</div>
<div id="ref-R-afex" class="csl-entry">
Singmann, Henrik, Ben Bolker, Jake Westfall, Frederik Aust, and Mattan S. Ben-Shachar. 2021. <em>Afex: Analysis of Factorial Experiments</em>. <a href="https://CRAN.R-project.org/package=afex">https://CRAN.R-project.org/package=afex</a>.
</div>
<div id="ref-R-forcats" class="csl-entry">
Wickham, Hadley. 2021a. <em>Forcats: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://CRAN.R-project.org/package=forcats">https://CRAN.R-project.org/package=forcats</a>.
</div>
<div id="ref-R-tidyr" class="csl-entry">
———. 2021b. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="factorial-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effects-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"source": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
